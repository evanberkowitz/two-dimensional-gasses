\section{Partition Function}

We wish to compute observables with the partition function
\begin{align}
	Z
	&=
	\tr{e^{-\beta(H-\mu N - \vec{h}\cdot\vec{S})}}
	&
	N &= \int d^2x\; \psi\adjoint(x)\psi(x)
	&
	\vec{S} = \half \int d^2x\; \psi\adjoint(x) ~ \vec{\sigma} ~ \psi(x)
\end{align}
where $N$ is the total number operator and $\vec{S}$ are spin operators which obey $[S^i, S^j] = i\epsilon^{ijk} S^k$.
In the latticized language 
\begin{align}
	N
	&\goesto
	\sum_x \Delta x^2 \psi\adjoint_x \psi_x
	=
	\sum_a \tilde{\psi}\adjoint_a \tilde{\psi}_a
	=
	\sum_a \tilde{n}_a
	=
	\tilde{N}
	\\
	\vec{S}
	&\goesto
	\half \sum_x \Delta x^2 \psi\adjoint_x \vec{\sigma} \psi_x
	=
	\half \sum_a \tilde{\psi}\adjoint_a ~ \vec{\sigma} ~ \tilde{\psi}_a
	=
	\tilde{\vec{S}}
\end{align}
\emph{with no powers of $\Delta x$ required}.
Explicitly, the local spin operators are
\begin{align}
	\tilde{S}^1 &= \half \left(\tilde{\psi}\adjoint_\uparrow \tilde{\psi}_\downarrow + \tilde{\psi}\adjoint_\downarrow \tilde{\psi}_\uparrow\right)
	&
	\tilde{S}^2 &= \frac{i}{2} \left( \tilde{\psi}\adjoint_\downarrow \tilde{\psi}_\uparrow - \tilde{\psi}\adjoint_\uparrow \tilde{\psi}_\downarrow\right)
	&
	\tilde{S}^3 &= \half \left(\tilde{\psi}\adjoint_\uparrow \tilde{\psi}_\uparrow - \tilde{\psi}\adjoint_\downarrow \tilde{\psi}_\downarrow\right).
\end{align}
We can isolate the dimensionful quantities
\begin{align}
	Z
	&=
	\tr{e^{-\left(\frac{\beta}{ML^2}\right)(HML^2 -M L^2 \mu N - M L^2 \vec{h} \cdot \vec{S})}}
\\
	&=
	\tr{e^{-\tilde{\beta}(\tilde{K}+\tilde{V}-\tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})}}
	&
	\tilde{\beta} &= \frac{\beta}{M L^2}
	&
	\tilde{\mu}   &= M L^2 \mu
	&
	\tilde{\vec{h}} &= M L^2 \vec{h}
	\label{eq:dimensionless}
\end{align}
where $\tilde{\beta}$, $\tilde{\mu}$, and $\tilde{\vec{h}}$ are dimensionless, and $\tilde{K}$ and $\tilde{V}$ are the dimensionless kinetic and potential operators in the dimensionless Hamiltonian \eqref{dimensionless hamiltonian}.

Let us Trotterize $\tilde{\beta}$ into $N_t$ time slices so that $\Delta \tilde{t} = \tilde{\beta}/N_t = \beta/M L^2 N_t$, which differs from $\hat{\gamma}$ in our prior work by $N_x^2$.
We begin with the identity
\begin{equation}
	e^{-\Delta \tilde{t}(\tilde{H} - \tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})}
	=
	e^{-\Delta \tilde{t}\tilde{K} / 2}
	e^{-\Delta \tilde{t} (\tilde{V} - \tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
	e^{-\Delta \tilde{t}\tilde{K} / 2}
	+
	\mathcal{O}(\Delta \tilde{t}^3) 
\end{equation}
where $\tilde{H} = \tilde{K} + \tilde{V}$ has been decomposed into the kinetic energy $\tilde{K}$ and the interaction term $\tilde{V}$ as in \eqref{dimensionless hamiltonian}.
Therefore,
\begin{align}
	\tr{e^{-\tilde{\beta}(\tilde{H}-\tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}}
	=
	\tr{
		\prod_{t=1}^{N_t}
		e^{-\Delta \tilde{t} (\tilde{H}-\tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
	}
	&=
	\tr{
		\prod_{t=1}^{N_t}
		e^{-\Delta \tilde{t}\tilde{K} / 2}
		e^{-\Delta \tilde{t} (\tilde{V} - \tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
		e^{-\Delta \tilde{t}\tilde{K} / 2}
	}
	+ \order{\Delta \tilde{t}^2}
	\nonumber\\
	&=
	\tr{
		\prod_{t=1}^{N_t}
		e^{-\Delta \tilde{t}\tilde{K}}
		e^{-\Delta \tilde{t} (\tilde{V} - \tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
	}
	+ \order{\Delta \tilde{t}^2}.
	\label{eq:trotterization}
\end{align}
which converges to the desired thermal trace as $\Delta \tilde{t} \goesto 0$.

We now begin a sequence of exact manipulations of the Trotterization \eqref{trotterization}.
Recall that the potential operator can be expressed as a sum of Lego spheres \eqref{dimensionless hamiltonian},
\begin{align}
	\tilde{V}
	&= \frac{1}{2} \sum_{ab} \tilde{n}_a \tilde{V}_{ab} \tilde{n}_b
	&
	\tilde{V}_{ab}
	&=
	\Volume \sum_{\vec{R}} \tilde{C}_{\vec{R}} \LegoSphere{\vec{R}}_{ab}
\end{align}
where $\tilde{V}_{ab}$ is a symmetric matrix and the radii $\vec{R}$ can be chosen however we like.
If $\tilde{V}$ has purely real negative eigenvalues (which imposes conditions on the bare coupling constants), then the following \emph{exact} Hubbard-Stratanovich transformation holds:
\begin{equation}
	\exp\left( \frac{1}{2} \sum_{ab}\tilde{n}_a \left(-\Delta\tilde{t} \tilde{V}\right)_{ab} \tilde{n}_b + \Delta \tilde{t} \tilde{\mu}\tilde{N} + \Delta\tilde{t} \tilde{\vec{h}}\cdot\tilde{\vec{S}}\right)
	=
	\frac{
		\int dA\; e^{-\frac{1}{2} A\transpose (-\Delta\tilde{t} \tilde{V})\inverse A + \tilde{\psi}\adjoint (A + \Delta\tilde{t} \tilde{\mu} + \half \Delta\tilde{t} \tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi}}
	}{
		\int dA\; e^{-\frac{1}{2} A\transpose (-\Delta\tilde{t} \tilde{V})\inverse A}
	}
\end{equation}
where $A$ is a vector with $\Volume$ components but the $\mu$ and $h$ terms are spatial constants and the fermionic term is implicitly summed over space.
So, we have the \emph{exact} rewriting of the Trotterized partition function \eqref{trotterization}
\begin{equation}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{-\Delta \tilde{t}(\tilde{V} - \tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})} }
	= 
	\frac{  
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}
	~	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t} \tilde{\mu} + \half \Delta\tilde{t} \tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi}} } 
	}{ 
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}
	}
	\label{eq:trotterization bilinearized}
\end{equation}
where $DA = \prod_{t=1}^{N_t} d A_t $.\footnote{
	We choose to group the chemical potential term with $V$ rather than $K$.
	The main reason is that both $N$ and $V$ are formed from products of local densities which commute $[\tilde{n}_{\sigma}(x),\tilde{n}_{\sigma'}(x')] = 0$, and therefore functional derivatives are simple:
	\begin{align*}
		-\frac{1}{\Delta t} \frac{\partial}{\partial \mu_{\sigma 'a'}}\exp\left( V - \Delta t \sum_{\sigma a}\mu_{\sigma a} n_{\sigma a}\right) 
		&
		=  n_{\sigma' a'} \exp\left( V - \Delta t \sum_{\sigma a}\mu_{\sigma a} n_{\sigma a}\right)
		= \exp\left( V - \Delta t \sum_{\sigma a}\mu_{\sigma a} n_{\sigma a}\right) n_{\sigma' a'}~.
	\end{align*} 
	This property allows us to compute density correlation functions with ease.
	However, the simple ``pulling down" of operators by derivatives occurs \emph{only if the argument of the exponential and its derivative commute}~\cite{10.2307/4146900}.
	If we were to instead group the chemical potential terms with $K$, functional derivatives cease to be simple because $[K,n_{\sigma}(x)] \neq 0$.
}

\subsection{The Fermion Matrix}\label{sec:fermion matrix}

Using fermion coherent states, we will now convert the trace over the Hilbert space into a determinant.
Using the conventions of M\"{u}nster Ch. 4~\cite{munster},
\begin{align}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t} \tilde{\mu} + \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi} }}
	=& \int \prod_{t=1}^{2N_t} d \eta^{\dagger}_t d\eta_t ~ e^{- \sum_{t}\sum_x \eta^{\dagger}_t(x) \eta_t(x)}~ \times
	\nonumber\\
	&
		\matrixElement{ -\eta_1 }{ e^{-\Delta \tilde{t}\tilde{K} }}{\eta_{2 N_t}}
		\matrixElement{ \eta_{2 N_t} }{ e^{ \tilde{\psi}\adjoint (A_{N_t} + \Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi} } }{\eta_{2 N_t-1}} ~ \times
	\nonumber\\
	&
		\cdots
	\nonumber\\
	&
		\matrixElement{ \eta_5 }{ e^{-\Delta \tilde{t}\tilde{K} }}{\eta_{4}}
		\matrixElement{ \eta_4 }{ e^{ \tilde{\psi}\adjoint (A_{2} + \Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi}} }{\eta_3} ~ \times
	\nonumber\\
	&
		\matrixElement{ \eta_3 }{ e^{-\Delta \tilde{t}\tilde{K} }}{\eta_{2}}
		\matrixElement{ \eta_2 }{ e^{ \tilde{\psi}\adjoint (A_{1} + \Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi}} }{\eta_1}
	\label{eq:coherent state trace}
\end{align}
where the coherent states
\begin{equation}
	\ket{\eta_t} = \exp\left( \sum_{\sigma a} \tilde{\psi}^{\dagger}_{\sigma a} \eta_{\sigma a t} \right) \ket{0}
	\label{eq:coherent state}
\end{equation}
are spatial vectors and spin doublets on a single timeslice.
To proceed we leverage the exponential identity (4.33) of Munster~\cite{munster},
\begin{equation}
	\matrixElement{ \eta }{ e^{\sum_{ij} \psi^{\dagger}_j A_{ji} \psi_i} }{ \eta' }
	=
	\exp\left[ \sum_{i j} \eta^{\dagger}_j (e^A)_{ji} \eta'_i \right]
\end{equation}
to carefully evaluate $\matrixElement{\eta}{ e^{-\Delta \tilde{t}\tilde{K}} }{\eta'}$ and $\matrixElement{\eta}{ e^{\tilde{\psi}\adjoint(A_t + \Delta \tilde{t} \tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi}} }{\eta'}$, keeping careful track of the spin degree of freedom,
\begin{align}
		\matrixElement{\eta}{ e^{-\Delta \tilde{t} \tilde{K}} }{\eta'}
	&= 
		\matrixElement{\eta}{ \exp\left(-\Delta \tilde{t} \sum_{ab \sigma} \tilde{\psi}^{\dagger}_{\sigma a} (\tilde{\kappa}_{ab} - \Volume \tilde{C}_0 / 2) \tilde{\psi}_{\sigma b} \right)}{\eta'}
	\nonumber\\
	&=
		\matrixElement{\eta}{ \exp\left(
			\begin{bmatrix} \tilde{\psi}^{\dagger}_{\up} &  \tilde{\psi}^{\dagger}_{\down}  \end{bmatrix} 
			\begin{bmatrix}
				-\Delta \tilde{t} (\tilde{\kappa}_{ab} - \Volume \tilde{C}_0 / 2)	& 0 \\
				0 									& -\Delta \tilde{t} (\tilde{\kappa}_{ab} - \Volume \tilde{C}_0 / 2) 
			\end{bmatrix} 
			\begin{bmatrix} \tilde{\psi}_{\up} \\  \tilde{\psi}_{\down}  \end{bmatrix}
		\right) }{\eta'}
	\nonumber\\
	& = 
		\exp\left( 
			\begin{bmatrix} {\eta}^{\dagger}_{\up} &  {\eta}^{\dagger}_{\down}  \end{bmatrix} 
			\exp\begin{pmatrix}
				-\Delta \tilde{t} \tilde{\kappa} + \Delta\tilde{t} \Volume \frac{\tilde{C}_0}{2} \one & 0 \\
				0 									& -\Delta \tilde{t} \tilde{\kappa} + \Delta\tilde{t} \Volume \frac{\tilde{C}_0}{2} \one
			\end{pmatrix} 
			\begin{bmatrix} {\eta}_{\up}' \\  {\eta}_{\down}'  \end{bmatrix}
		\right)
\end{align}
where $\tilde{\kappa}$ is given in the dimensionless Hamiltonian \eqref{dimensionless hamiltonian} and the $\tilde{C}_0$ term is diagonal in space.
By an analogous sequence of manipulations, one also finds
\begin{align}
	\matrixElement{\eta}{ e^{\tilde{\psi}\adjoint \cdot (A_t + \Delta\tilde{t} \tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi}} }{\eta'}
	&=
		\matrixElement{\eta}{ \exp\left(
			\begin{bmatrix} \tilde{\psi}^{\dagger}_{\up} &  \tilde{\psi}^{\dagger}_{\down}  \end{bmatrix} 
			\left(
				(A + \Delta\tilde{t}\tilde{\mu})\one + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}
			\right)
			\begin{bmatrix} \tilde{\psi}_{\up} \\  \tilde{\psi}_{\down}  \end{bmatrix}
		\right) }{\eta'}
	\label{eq:gaussian spinors}\\
	& = 
		\exp\left(
			\begin{bmatrix} \eta^{\dagger}_{\up} &  \eta^{\dagger}_{\down}  \end{bmatrix} 
			\exp\left(
				(A + \Delta\tilde{t}\tilde{\mu})\one + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}
			\right)
			\begin{bmatrix} \eta'_{\up} \\  \eta'_{\down}  \end{bmatrix}
		\right)
\end{align}
where the inner exponential is space-dependent through $A$.
So, we can rewrite the Hilbert space trace in the bilinearized Trotterization \eqref{trotterization bilinearized}
\begin{align}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t} \tilde{\mu} + \half \Delta\tilde{t} \tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi}} }
	=& \int D\eta\adjoint D\eta \exp\left( - \sum_{t=1}^{2N_t}\sum_{a\sigma} \eta\adjoint_{\sigma a t} \eta_{\sigma a t}\right)~ \times
	\nonumber\\
	&
		\exp\left[ \sum_{ab\sigma} (-\eta_{\sigma a\;1})\adjoint \left(e^{-\Delta \tilde{t} (\tilde{\kappa}-\Volume\tilde{C}_0/2)}\right)_{ab} \eta_{\sigma b\;2N_t} \right]
    \nonumber\\
    &   \hspace{1in}
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;2N_t} \left(e^{A_{N_t}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma} }\right)_{ab}^{\sigma\sigma'} \eta_{\sigma' b\;2N_t-1}\right] ~ \times
	\nonumber\\
	&
		\cdots
	\nonumber\\
	&
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;5} \left(e^{-\Delta \tilde{t} (\tilde{\kappa}-\Volume\tilde{C}_0/2)}\right)_{ab} \eta_{\sigma b\;4} \right]
    \nonumber\\
    &   \hspace{1in}
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;4} \left(e^{A_{2}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}}\right)_{ab}^{\sigma\sigma'} \eta_{\sigma' b\;3}\right] ~ \times
	\nonumber\\
	&
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;3} \left(e^{-\Delta \tilde{t} (\tilde{\kappa}-\Volume\tilde{C}_0/2)}\right)_{ab} \eta_{\sigma b\;2} \right]
    \nonumber\\
    &   \hspace{1in}
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;2} \left(e^{A_{1}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}}\right)_{ab}^{\sigma\sigma'} \eta_{\sigma' b\;1}\right]
	\label{eq:grassmann integral}
\end{align}
where the measure is given by
\begin{equation}
	D\eta\adjoint D\eta \equiv \prod_{t=1}^{2N_t} \left\{ \prod_{a, \sigma} d \eta^{\dagger}_{\sigma a\; t} d\eta_{\sigma a\; t} \right\}.
\end{equation}
Written with the Grassmann fields the action is
\begin{align}
	S &= 
	\frac{1}{2} \sum_{ab t} A_{at} \left[(-\Delta\tilde{t} \tilde{V})\inverse\right]_{ab} A_{bt}
+	\sum_{a \alpha t} \eta\adjoint_{\alpha a t} \eta_{\alpha a t}
-	\sum_{\substack{ab \alpha\alpha' \\ t\text{ even}}} \eta\adjoint_{\alpha a t+1} (-1)^{[t=2N_t]}\left[\BB\inverse\right]^{\alpha\alpha'}_{ab} \eta_{\alpha' b t}
-	\sum_{\substack{ab \alpha\alpha' \\ t\text{ odd}}}\eta\adjoint_{\alpha a\; t+1} \FF(\tilde{h})^{\alpha\alpha'}_{tab} \eta_{\alpha' b t}
\nonumber\\
	&=
	\frac{1}{2} \sum_{ab t} A_{at} \left[(-\Delta\tilde{t} \tilde{V})\inverse\right]_{ab} A_{bt}
+	\sum_{a \alpha t} \eta\adjoint_{\alpha a t} \eta_{\alpha a t}
-	\sum_{\substack{ab \alpha \\ t\text{ even}}} \eta\adjoint_{\alpha a t} (-1)^{[t=2N_t]}\left[B\inverse\right]_{ab} \eta_{\alpha b t}
-	\sum_{\substack{a \alpha\alpha' \\ t\text{ odd}}}\eta\adjoint_{\alpha a\; t+1} \FF(\tilde{h})^{\alpha\alpha'}_{ta} \eta_{\alpha' a t}
	\label{eq:grassmann action}
\end{align}
where we include the gaussian Grassmann contribution from the coherent-state resolution of the identity required for the trace \eqref{coherent state trace} and leverage the fact that the hopping in $\BB$ does not mix spins and $\FF$ does not mix sites.
Using this action we may write
\begin{align}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{-\Delta \tilde{t}(\tilde{V} - \tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})} }
	= 
	\frac{  
		\int DA\; D\eta\adjoint D\eta\; e^{-S\text{ in \eqref{grassmann action}}}
	}{ 
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}
	}
\end{align}

Performing the Grassmannian integration yields a fermion determinant for the Hubbard-Stratonovich trace,
\begin{align}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}} e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t}\tilde{\mu} + \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi}} }
	=
	\int D\eta\adjoint D\eta ~ e^{- \eta^{\dagger} ~ \DD ~ \eta} = \det \DD
	\label{eq:fermion determinant with 2nt timeslices}
\end{align}
where $\DD$ is $(2N_t)\times(\Volume)\times(2\text{ spins})$ on a side.
Writing
\begin{align}
	\BB &= B \otimes \one
	&
	B &= \exp \Delta\tilde{t} \left(\tilde{\kappa} - \half \Volume\tilde{C}_0\right)
	\label{eq:BB with C0}\\
	\FF_t &= \left(e^{A_{t}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}}\right)
	\label{eq:FF with C0}
\end{align}
where the doubly-struck quantities are also square matrices in spin dimensions; the hopping matrix is time-independent and spin-diagonal, $\FF$ is space-diagonal.
Using this notation we can write the Fermion matrix as
\begin{align}
	\DD = \begin{bmatrix} 
			\one            & 0         & 0                 & 0         & 0      & \cdots & 0       & 0                     & +\BB^{-1}
		\\	-\FF_1(\tilde{h}) & \one      & 0                 & 0         & 0      & \cdots & 0       & 0                     & 0
		\\	0               & -\BB^{-1}   & \one              & 0         & 0      & \cdots & 0       & 0                     & 0
		\\	0               & 0         & -\FF_2(\tilde{h})   & \one      & 0      & \cdots & 0       & 0                     & 0
		\\	0               & 0         & 0                 & -\BB^{-1}   & \one   & \cdots & 0       & 0                     & 0
		\\	\vdots          & \vdots    & \vdots            & \vdots    & \vdots & \ddots & \vdots  & \vdots                & \vdots
		\\	0               & 0         & 0                 & 0         & 0      & \cdots & -\BB^{-1} & \one                  & 0
		\\	0               & 0         & 0                 & 0         & 0      & \cdots & 0       & -\FF_{N_t}(\tilde{h})   & \one
	\end{bmatrix}.
	\label{eq:DD}
\end{align}
The determinant of $\DD$ is equal to the determinant
\begin{align}
    \dd'
	=
	\begin{bmatrix}
			\BB                  & 0                             & 0                             & 0             & \cdots & 0                                & +\FF_{N_t}(\tilde{h})
		\\	-\FF_{1}(\tilde{h})  & \BB                    & 0                             & 0             & \cdots & 0                                & 0
		\\	0                           & -\FF_{2}(\tilde{h})    & \BB                    & 0             & \cdots & 0                                & 0
		\\	0                           & 0                             & -\FF_{3}(\tilde{h})    & \BB    & \cdots & 0                                & 0
		\\	\vdots                      & \vdots                        & \vdots                        & \vdots        & \ddots & \vdots                           & \vdots
		\\	0                           & 0                             & 0                             & 0             & \cdots & \BB                       & 0
		\\	0                           & 0                             & 0                             & 0             & \cdots & -\FF_{N_t-1}(\tilde{h})   & \BB
	\end{bmatrix},
\end{align}
up to a constant
\begin{align}
    \det \DD = \frac{ \det \dd' }{ \det \BB^{N_t} } = \frac{ \det \dd' }{ \det \exp 2 \tilde{\beta}\tilde{\kappa} }
\end{align}
and we can write the $\det \dd'$ in terms of a `block sausage'.

However, we will show that it is advantageous to multiply by $-\BB\inverse \otimes \one_{N_t}$ to get
\begin{align}
    \dd
	=
	\begin{bmatrix}
			-\one                           & 0                                 & 0                                 & 0         & \cdots & 0                                    & -\BB\inverse\FF_{N_t}(\tilde{h})
		\\	+\BB\inverse\FF_{1}(\tilde{h})  & -\one                             & 0                                 & 0         & \cdots & 0                                    & 0
		\\	0                               & +\BB\inverse\FF_{2}(\tilde{h})    & -\one                             & 0         & \cdots & 0                                    & 0
		\\	0                               & 0                                 & +\BB\inverse\FF_{3}(\tilde{h})    & -\one     & \cdots & 0                                    & 0
		\\	\vdots                          & \vdots                            & \vdots                            & \vdots    & \ddots & \vdots                               & \vdots
		\\	0                               & 0                                 & 0                                 & 0         & \cdots & -\one                                & 0
		\\	0                               & 0                                 & 0                                 & 0         & \cdots & +\BB\inverse\FF_{N_t-1}(\tilde{h})   & -\one
	\end{bmatrix},
	\label{eq:fermion matrix}
\end{align}
or in index notation (letting $\delta_{1,N_t+1}=1$)
\begin{align}
	\dd_{\alpha a t, \alpha' a' t'} &= (-1)^{[t'=N_t]} [\BB\inverse]^{\alpha\alpha''}_{aa''}\FF_{t' a''a'}^{\alpha''\alpha'} \delta_{t,t'+1} - \delta_{\alpha\alpha'} \delta_{aa'} \delta_{tt'}
	\\
	&= (-1)^{[t'=N_t]} [B\inverse]_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} - \delta_{\alpha\alpha'} \delta_{aa'} \delta_{tt'}
\end{align}
which actually has $\det \DD = \det \dd$ and the way the sausage appears is apparent.
Using the Shur complement, one has
\begin{align}
	\det \dd &= \det\left( \one + \UU \right)
	&
	\UU = \BB\inverse \FF_{N_t} \cdots \BB\inverse \FF_{2} \BB\inverse \FF_1.
	\label{eq:sausage}
\end{align}
The sausage $\UU$ is (2 spins)$\times \Volume$ on a side.
Since the $\tilde{C}_0$ piece is diagonal in space we can pull it out of $B$ and think of it as offsetting $\tilde{\mu}\goesto \tilde{\mu} + \half \Volume \tilde{C}_0$; this reorganization can even be seen naturally at the Hamiltonian \eqref{dimensionless hamiltonian} level, as the $\tilde{C}_0$ term can be reexpressed as a number operator term $- \tilde{C}_0 \tilde{N}/2$.
When we \incode{tdg/action.py\#L73}{construct the auxiliary field action} \eqref{computational partition function} we incorporate this shift in $\tilde{\mu}$ and henceforth use
\begin{align}
	\BB &= B \otimes \one
	&
	B &= \exp \Delta\tilde{t} \tilde{\kappa}
	\label{eq:BB}\\
	\FF_t &= \left(e^{A_{t}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}}\right)
	&
	\tilde{\mu} &= M L^2 \mu +\Volume\tilde{C}_0/2
	\label{eq:FF}
\end{align}

Note that we can separate
\begin{align} 
	\FF_t 
	&= e^{A_{t}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}}
	= e^{A_t + \Delta\tilde{t}\tilde{\mu}}\left( \cosh \half \Delta\tilde{t} \abs{\tilde{h}} \one + \frac{\tilde{\vec{h}}\cdot \sigma}{\abs{\tilde{h}}}\sinh \half \Delta\tilde{t} \abs{\tilde{h}} \right)
	\label{eq:FF explicitly}
	&
	\Bigg[\abs{\tilde{h}} &\text{ means } \sqrt{\tilde{h}\cdot\tilde{h}}\text{; see below \eqref{finite-h determinant algorithm}}\Bigg]
\end{align}
into a space-dependent part $e^{A_t}$, a spin-dependent part $\exp( \half \Delta\tilde{t}\tilde{\vec{h}} \cdot \vec{\sigma})$ and the spin- and space- independent $\tilde{\mu}$ piece.
We can collect the space-independent part, pulling them through the sausage,
\begin{align}
	\UU 
	&= \exp\left(\half \Delta\tilde{t} \tilde{\vec{h}}\cdot\vec{\sigma}\right)^{N_t} \BB\inverse (e^{A_{N_t} + \Delta\tilde{t}\tilde{\mu}} \otimes\one)\cdots \BB\inverse (e^{A_2 + \Delta\tilde{t}\tilde{\mu}}\otimes\one) \BB\inverse (e^{A_1 + \Delta\tilde{t}\tilde{\mu}}\otimes \one)
	\\
	&= \exp\left(\half \tilde{\beta}\tilde{\vec{h}}\cdot\vec{\sigma}\right) \begin{pmatrix} zU & 0 \\ 0 & zU \end{pmatrix}
	&
	z &= \exp(\tilde{\beta} \tilde{\mu})
	\label{eq:fugacity}\\
	U &= B\inverse e^{A_{N_t}} \cdots B\inverse e^{A_2} B\inverse e^{A_1}
\end{align}
where $z$ is the fugacity.
Note that (up to the effects of the $\tilde{C}_0$ offset \eqref{FF}) the fugacity can be computed directly from the dimensionful parameters; $z=\exp(\tilde{\beta}\tilde{\mu})=\exp(\beta\mu)$, using the dimensionless definitions \eqref{dimensionless}.\footnote{
	Or, if you prefer, the $z$ in the matrix is the physical fugacity $z$ rescaled by $\exp(\tilde{\beta} \tilde{C}_0/2)$
}
Similarly, the external field parameter matches, $\tilde{\beta}\tilde{\vec{h}} = \beta \vec{h}$.

We immediately see that if $\tilde{\vec{h}} = 0$ the spin sectors yield the same determinant, $\det\dd = \det (1+zU)^2$.
Therefore, when $\tilde{h}=0$ the fermion determinant $\det\dd$ is positive semidefinite.

Moreover, since the $2\times2$ $U$ block matrix is spin-independent, for evaluating the fermion determinant we can always rotate by some $O$ that operates only in spin space and diagonalizes $\tilde{\vec{h}}\cdot\vec{\sigma}$,
\begin{align}
	\det \dd 
	= \det(\one+\UU)
	&= \det\left(\one + e^{\half \tilde{\beta} \tilde{\vec{h}}\cdot\vec{\sigma}}(zU\otimes\one)\right)
	= \det\left(\one + O\inverse O e^{\half \tilde{\beta} \tilde{\vec{h}}\cdot\vec{\sigma}} (zU\otimes\one)\right)
	\nonumber\\
	&= \det\left(\one + O e^{\half \tilde{\beta} \tilde{\vec{h}}\cdot\vec{\sigma}} (zU\otimes\one)O\inverse \right)
	= \det\left(\one + O e^{\half \tilde{\beta} \tilde{\vec{h}}\cdot\vec{\sigma}} O\inverse (zU\otimes\one) \right)
	\nonumber\\
	&= \det\left(\one + e^{\half \tilde{\beta} \sqrt{\tilde{\vec{h}}\cdot\tilde{\vec{h}}} \sigma_3 } (zU\otimes\one) \right)
	\\
	&= \det\left( 1 + e^{+\half \tilde{\beta}\sqrt{\tilde{\vec{h}}\cdot\tilde{\vec{h}}}} zU\right)\det\left( 1 + e^{-\half \tilde{\beta}\sqrt{\tilde{\vec{h}}\cdot\tilde{\vec{h}}}} zU\right)
	\label{eq:finite-h determinant algorithm}
\end{align}
which means that to evaluate the fermion determinant for any $\tilde{h}$ we can always evaluate an equivalent expression with just $\vec{\tilde{h}}\parallel\hat{z}$.
So, any external magnetic field of the same magnitude causes the same difficulty in sign problem.

The construction $\sqrt{\tilde{\vec{h}}\cdot\tilde{\vec{h}}}$ in the fermion matrix evaluation \eqref{finite-h determinant algorithm} looks peculiar; surely it should be $\abs{\tilde{h}}$?
No.
Later, when we do canonical projections, we will find that complex $h$ is needed and, moreover, the construction needs the imaginary piece, and therefore the square root of the square, rather than the absolute modulus.

\subsection{The Auxiliary-Field Action}

Now we may write a computationally-tractable expression for the partition function as a statistical system of classical auxiliary fields.
Starting with the bilinear \eqref{trotterization bilinearized} we can now replace the Hilbert space trace with the first-pass fermion determinant \eqref{fermion determinant with 2nt timeslices} and trade that for the determinant of the preferable fermion matrix \eqref{sausage},
\begin{align}
	Z=\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{-\Delta \tilde{t}(\tilde{V} - \tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})} }
	= 
	\frac{  
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}
	~	\left(\det \DD = \det \dd = \det \one + \UU \right)
	}{ 
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}
	}.
\end{align}
When $\vec{h}\neq 0$ we may use single-species sausage $U$ and reuse it for each spin to compute the determinant \eqref{finite-h determinant algorithm}.
When $\vec{h} = 0$ it is even simpler; as that determinant is a square.
However, in that case it may prove beneficial to use pseudofermions to stochastically estimate the determinant.

The denominator may be evaluated exactly.
For each timeslice we get $(\det -2\pi \Delta\tilde{t} \tilde{V})^{1/2}$.
Therefore
\begin{align}
	\left[\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}\right]\inverse
	=
	(\det -2\pi \Delta\tilde{t} \tilde{V})^{-N_t/2}
	=
	\exp\left[ -\frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t} \tilde{V}} \right].
\end{align}

Throwing the determinant up into the action we arrive at
\begin{align}
	S &= \half \sum_t A_t\transpose (-\Delta\tilde{t}\tilde{V})\inverse A_t - \log\det(\one+\UU) + \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }
	&
	Z &= \int DA\; e^{-S}.
	\label{eq:computational partition function}
\end{align}
where we even have tracked the usually-irrelevant constant.

\subsection{Fermion Matrix Eigenvectors}

The advantage of this fermion matrix is the identity matrix appearing on the diagonal, which allows us to easily generate $N_t$ eigenvectors of $\dd$, as follows.

Suppose we have an eigenvector $u_{\alpha' a' t'}$ so that $(\dd+\one)u = \lambda u$ where $\lambda$ is some eigenvalue of $(\dd+\one)$ and $\dd u = (\lambda-1) u$.
In other words, $u$ is an eigenvector of the off-time-diagonal piece of $\dd$, which makes it an eigenvector of $\dd$ itself, since the only difference is the identity,
\begin{align}
    (\dd+\one)u &= \lambda u
    \nonumber\\
    (\dd+\one)_{\alpha a t, \alpha' a' t'}u_{\alpha' a' t'} &= \lambda u_{\alpha a t}
    \nonumber\\
	(-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} u_{\alpha' a' t'} &= \lambda u_{\alpha a t}
\end{align}
If we consider the vector $v$ such that $v_{\alpha a t} = e^{2\pi i t/N_t} u_{\alpha a t}$ then
\begin{align}
    [(\dd+\one)v]_{\alpha a t} = 
	(-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} v_{\alpha' a' t'} &=
	(-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} e^{2\pi i t' /N_t} u_{\alpha' a' t'} 
\end{align}
Since the right-hand side is 0 unless $t=t'+1$ we can replace $t'$ with $t-1$,
\begin{align}
    [(\dd+\one)v]_{\alpha a t}
    &=
	(-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} e^{2\pi i (t-1) /N_t} u_{\alpha' a' t'} 
    \nonumber\\
    &=
	e^{2\pi i (t-1) /N_t} (-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} u_{\alpha' a' t'} 
    =
    e^{2\pi i (t-1) /N_t} [(\dd+\one)u]_{\alpha a t}
\end{align}
since the phase now escapes the sum on $t'$.
But $(\dd+\one)u = \lambda u$ by assumption so
\begin{align}
    [(\dd+\one)v]_{\alpha a t}
    =
    e^{2\pi i (t-1) /N_t} \lambda u_{\alpha a t}
    =
	e^{-2\pi i /N_t} \lambda \left(e^{2\pi i t / N_t} u_{\alpha a t}\right)
    =
    e^{-2\pi i /N_t} \lambda v_{\alpha a t}
\end{align}
So, for every eigenvector of $\dd$ with eigenvalue $(\lambda-1)$ we can immediately construct another eigenvector with eigenvalue $(\lambda e^{2\pi i \cdot 1/N_t}-1)$, and another with $(\lambda e^{2\pi i\cdot 2/N_t}-1)$ and so on until we repeat with $e^{2\pi i \cdot N_t/N_t}=1$.

This only demonstrates that \emph{if you could find an eigenvector of $\dd$ you'd be in business}.
So: How can we construct eigenvectors of $\dd$ (or $\dd+\one$)?

Now it helps to think of $u$ as an $N_t$-vector of $2\times\Volume$ vectors and apply $(\dd+\one)$,
\begin{align}
    (\dd+\one) u &= \lambda u
    \nonumber\\
	\begin{bmatrix}
			0                               & 0                                 & 0                                 & 0         & \cdots & 0                                    & -\BB\inverse\FF_{N_t}(\tilde{h})
		\\	+\BB\inverse\FF_{1}(\tilde{h})  & 0                                 & 0                                 & 0         & \cdots & 0                                    & 0
		\\	0                               & +\BB\inverse\FF_{2}(\tilde{h})    & 0                                 & 0         & \cdots & 0                                    & 0
		\\	0                               & 0                                 & +\BB\inverse\FF_{3}(\tilde{h})    & 0         & \cdots & 0                                    & 0
		\\	\vdots                          & \vdots                            & \vdots                            & \vdots    & \ddots & \vdots                               & \vdots
		\\	0                               & 0                                 & 0                                 & 0         & \cdots & 0                                    & 0
		\\	0                               & 0                                 & 0                                 & 0         & \cdots & +\BB\inverse\FF_{N_t-1}(\tilde{h})   & 0
	\end{bmatrix}
    \begin{bmatrix}
            \uu_1
        \\  \uu_2
        \\  \uu_3
        \\  \uu_4
        \\  \vdots
        \\  \uu_{N_t-1}
        \\  \uu_{N_t}
    \end{bmatrix}
    &=
    \lambda
    \begin{bmatrix}
            \uu_1
        \\  \uu_2
        \\  \uu_3
        \\  \uu_4
        \\  \vdots
        \\  \uu_{N_t-1}
        \\  \uu_{N_t}
    \end{bmatrix}
\end{align}
where each $\uu$ is a $2\times\Volume$ vector.
This is (obviously) a set of linear equations
\begin{align*}
	\lambda \uu_1 &= -\BB\inverse \FF_{N_t} \uu_{N_t}
    \\
	\lambda \uu_2 &=+\BB\inverse \FF_{1} \uu_{1}
    \\
	\lambda \uu_3 &= +\BB\inverse \FF_{2} \uu_{2}
    \\
    \vdots \quad &= \qquad \vdots
    \\
    \lambda \uu_{N_t} &= +\BB\inverse \FF_{N_t} \uu_{N_t-1}
\end{align*}
If we multiply the first equation by $\lambda$ we can substitute the last equation in on the right-hand side.
Then multiply the resulting equation by $\lambda$ and substitute the second-to-last equation in, replacing $\uu_{N_t-1}$.
Take this procedure `all the way around' to find
\begin{align}
    \left(-\BB\inverse \FF_{N_t} \BB\inverse \FF_{N_t-1} \BB\inverse \cdots \FF_2 \BB\inverse \FF_1 \right) \uu_1 &= \lambda^{N_t} \uu_1
\end{align}
In other words the first $2\times\Volume$ entry of an eigenvector of $\dd+\one$ is an eigenvector of the sausage.
You can construct the remaining entries by using those linear equations, $\uu_2 = \lambda\inverse\BB\inverse \FF_1 \uu_1$, $\uu_3$ by applying $\lambda\inverse \BB\inverse \FF_2$ to $\uu_2$ and so on.
One also need not focus on $\uu_1$; just rotate the sausage and find its eigenvectors to get the eigen-$\uu$s of interest.

This is marvelous: if you can reliably construct the block sausage you need only calculate its $2\times\Volume$ eigenvectors and you get the $2\times\Volume\times N_t$ eigenvectors of $\dd$.
{\bf I have not considered the numerical stability or tractability of this procedure, but presumably if we can construct the sausage in a stable way everything else follows.}
For a detailed discussion of this operator see \Ref{Wynen:2018ryx} (it is the `exponential $\alpha=0$' operator), where it is shown $\dd$ has an ergodicity problem when the lattice is bipartite (if $\vec{h}=0$).
\emph{For that reason we always pick a lattice with an odd number of sites on at least one side.}

\subsection{Correlation Functions}\label{sec:correlation functions}

We often want to evaluate not just the partition function but the expectation value of some operators, such as $\expectation{\tilde{n}_\sigma(a)}$ or $\expectation{\tilde{n}_{\sigma}(a)\tilde{n}_{\sigma'}(a')}$ for some spins $\sigma, \sigma'$ and (dimensionless) positions $a, a'$.
Let us currently restrict our attention to equal-time correlators on the same, first, timeslice, so that numerically we wish to evaluate
\begin{align}
	\expectation{\O}
	=
	\oneover{Z} \tr{ \left(\prod_{t=1}^{N_t} e^{-\Delta\tilde{t} \tilde{K}} e^{-\Delta\tilde{t}(\tilde{V} -\tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})}\right) \O}.
	\label{eq:expectation}
\end{align}
One may of course work with the operators directly and re-perform the Grassmann algebra with the operator inserted.
However, functional differentiation produces the exact same answer and is easier to perform.

Let us add to the chemical potential and external field terms space- and time-dependent perturbations;
\begin{align}
	\mu &\goesto \mu_{t,a} = \mu + \delta \mu_{t,a}
	&
	\vec{h} &\goesto \vec{h}_{t,a} = \vec{h} + \delta \vec{h}_{t,a}
	\\\
	\tilde{\mu} \tilde{N} & \goesto \sum_a \tilde{\mu}_a \tilde{n}_a = \tilde{\mu}\tilde{N} + \sum_a \delta\tilde{\mu}_a \tilde{n}_a
	&
	\tilde{\vec{h}} \cdot \tilde{\vec{S}} & \goesto \sum_a \tilde{\vec{h}}_a\cdot \tilde{\vec{S}}_a = \tilde{\vec{h}}\cdot\tilde{\vec{S}} + \sum_a \delta\tilde{\vec{h}}_a \cdot \tilde{\vec{S}}_a
	&
	Z &\goesto Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}});
	\label{eq:local perturbations}
\end{align}
and the perturbation can be different on each timeslice.
We will functionally differentiate the modified partition function $Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})$ with respect to these perturbations and then set them to zero.
For example
\begin{align}
	\left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} \log Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\mu=0, \delta\vec{h}=0}
	&=
	\left.\oneover{Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\nonumber\\
	&=
	\left.\oneover{Z} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\nonumber\\
	&=\oneover{Z} \tr{\left(\prod_{t=1}^{N_t}e^{-\Delta\tilde{t} \tilde{K}} e^{-\Delta\tilde{t}(\tilde{V} -\tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})}\right) \tilde{n}_a} 
	= \expectation{\tilde{n}_a}.
	\label{eq:functionally differentiate}
\end{align}
where in the last line we specialized to differentiating with respect to a fluctuation on timeslice 1; functionally differentiating with respect to a fluctuation on a different timeslice simply inserts $\tilde{n}_a$ in the middle of the Trotterized product but by time translation invariance (or the cyclicity of the trace) we can bring the trace into a similar form with the operator rightmost.

We may replace $Z$ with our computationally-tractable auxiliary-field formulation in the functional derivative \eqref{functionally differentiate} to get estimators of the desired expectation value.
Since the perturbations \eqref{local perturbations} are spacetime local they go into the fermion matrix $\dd$ \eqref{fermion matrix} and the sausage $\UU$ \eqref{sausage} straightforwardly by making the promotions from space (and time) constants.
Inserting the auxiliary-field formulation of $Z$ \eqref{computational partition function} into the derivative one finds
\begin{align}
	\expectation{\tilde{n}_a} &= \left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} \log Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\mu=0, \delta\vec{h}=0}
	=
	\left.\oneover{Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	=
	\left.\oneover{Z} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\nonumber\\
	&=
	\left.\oneover{Z} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}}
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t - \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }}
	~	\det \left(\one + \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}}) \right)
	\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\nonumber\\
	&=
	\oneover{Z}
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t - \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }}
	~	\left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}}
	~	\det \left(\one + \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}}) \right)\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\nonumber\\
	&=
	\oneover{Z}
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t - \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }}
		\det \left(\one + \UU \right) \tr{\left(\one + \UU \right)\inverse \left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}}
	\label{eq:fermionic particle number}
\end{align}
where $\UU$ with no arguments has the local fluctuations set to zero and we assume that $(1+\UU)$ is invertible so that the derivative of the determinant may be replaced via the identity $\partial \det{A} = \det A ~ \tr{ A\inverse \partial A}$.

Now we need to know the derivatives of the ingredients of the sausage, evaluated at 0 fluctuation.
Since $\BB$ only changes with the hopping parameter or with the lattice geometry, we focus on derivatives of $\FF$.
The simplest is
\begin{align}
	\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} \FF_{t'} &= \delta_{tt'} \FF_{t'} \PP_a
	&
	\left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{1,a}} \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	&= \UU \PP_a
	\label{eq:dmu replacement}
\end{align}
where $\PP_a$ is a spin-independent projector to site $a$.
This derivative is simple because $\tilde{\mu}$ appears inside the matrix exponential $\FF$ \eqref{FF} coupled to the (spin) identity, and the identity commutes with all the Pauli matrices.
In the generic case, where $\vec{h}\neq0$ the functional derivatives of $\FF$ with respect to the external field is not simple,
\begin{align}
	\left.\oneover{\Delta\tilde{t}}\frac{\partial}{\partial \delta \tilde{h}^i_{t,a}} \FF_{t'}\right|_{\delta\tilde{\mu} = 0, \delta \tilde{h}=0}
	&=
	\delta_{tt'}\PP_a e^{A_t + \Delta\tilde{t}\tilde{\mu}}\left(
		\left[\frac{\tilde{h}^i_{t,a}}{2 \abs{\tilde{h}}} + \frac{\sigma^i/\Delta\tilde{t}}{\abs{\tilde{h}}}\right]\sinh \Delta\tilde{t}\abs{\tilde{h}}
		+
		\tilde{\vec{h}}\cdot\vec{\sigma} \left[
				\frac{\tilde{h^i}}{2 \abs{\tilde{h}}^2} \cosh \Delta\tilde{t} \abs{\tilde{h}}
			-	\frac{\tilde{h^i}}{\Delta\tilde{t} \abs{\tilde{h}}^{3}} \sinh \Delta\tilde{t} \abs{\tilde{h}}
		\right]
	\right).
	\label{eq:dF}
\end{align}
To be able to cleanly write the derivative of $\UU$ in the generic case we multiply \eqref{dF} by the the identity $\FF\FF\inverse$.
After much massaging and cancellation one finds, suppressing the (common) argument of sinh and cosh $\half\Delta\tilde{t}\abs{\tilde{h}}$ for brevity,
\begin{align}
	\left.\oneover{\Delta\tilde{t}}\frac{\partial}{\partial \delta \tilde{h}^i_{t,a}} \FF_{t'}\right|_{\delta\tilde{\mu} = 0, \delta \tilde{h}=0}
	&= \delta_{tt'} \FF_{t'} \PP_a \left[
				\half \hat{h}^i \hat{h}^k
			+	\frac{\sinh \cosh}{\Delta\tilde{t} \abs{\tilde{h}}} \left(\delta^{ik}-\hat{h}^i\hat{h}^k\right)
			+	\frac{i \sinh^2}{\Delta\tilde{t} \abs{h}} \epsilon_{ijk} \hat{h}^j
		\right]\sigma_k
	\label{eq:dFdh factor}
\end{align}
so that if we differentiate $\UU$ with respect to a fluctuation of $\tilde{h}$ on timeslice 1 we can just append everything after $\FF_t$ to the right of $\UU$; on other timeslices we make the similar insertion to the right of $\FF_t$.
When $\vec{h}=0$ we have the simplification (by taking a careful limit, holding $\hat{h}$ a unit vector)
\begin{align}
	\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{h}^i_{t,a}} \FF_{t'} &= \delta_{tt'} \FF_{t'} \half \sigma^i \PP_a
	&
	\left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{h}^i_{1,a}} \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	&= \UU \half \sigma^i \PP_a = \UU \PP_a \half\sigma^i 
	&
	(\vec{h} &\goesto 0)
	\label{eq:dFdh with h=0}
\end{align}
From the more explicit form \eqref{dFdh factor} we can see how the $\tilde{h}\goesto0$ limit \eqref{dFdh with h=0} emerges; the last term vanishes while the $\delta$ term survives and the $\hat{h}^i\hat{h}^k$ terms cancel.
Note that if we take the inner product of the matrix element \eqref{dFdh factor} with $\hat{h}$ one finds
\begin{align}
	\hat{h}^i \left.\oneover{\Delta\tilde{t}}\frac{\partial}{\partial \delta \tilde{h}^i_{t,a}} \FF_{t'}\right|_{\delta\tilde{\mu} = 0, \delta \tilde{h}=0}
	&= \delta_{tt'} \FF_{t'} \PP_a \half(\hat{h}\cdot\sigma)
\end{align}
as expected.

Finally, note that the insertion \eqref{dFdh factor} contains terms of all orders in $\Delta \tilde{t}$.
Since our Trotterization \eqref{trotterization} is only valid to $\order{\Delta \tilde{t}^2}$, most of that dependence is indistinguishable from discretization error.
Why not jump straight to the discretization-independent observable?
Just like the $\vec{h}\goesto0$ limit,
\begin{align}
	\lim_{\Delta\tilde{t}\goesto0} \left[
		\half \hat{h}^i \hat{h}^k
	+	\frac{\sinh \cosh}{\Delta\tilde{t} \abs{\tilde{h}}} \left(\delta^{ik}-\hat{h}^i\hat{h}^k\right)
	+	\frac{i \sinh^2}{\Delta\tilde{t} \abs{h}} \epsilon_{ijk} \hat{h}^j
	\right]\sigma_k
	=
	\half \sigma^i + \order{\Delta \tilde{t}}.
\end{align}
So, we can replace
\begin{align}
	\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{h}^{i}_{x}} \FF
	&\rightsquigarrow
	\FF \PP_x \half \sigma^i
	&
	\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{h}^{i}_{x}} \UU
		&\rightsquigarrow
	\UU \PP_x \half \sigma^i
	\label{eq:dh replacement}
\end{align}
and we can check that the $\Delta\tilde{t}$-independent pieces of second derivatives (and beyond) all agree with this replacement rule.
In a calculation of the spin similar to the number operator \eqref{fermionic particle number}, this goes inside the trace, giving $\tr{(1+\UU)\inverse \UU \PP_x \half \sigma^i}$.

\subsection{Wick's Theorem and Tensor Contractions}\label{sec:contractions}

A common approach for translating operator observables into computational observables is to leverage Wick's theorem.
We add into our Trotterization \eqref{trotterization} a source of fermion number,
\begin{align}
	Z[\chi\adjoint, \chi] = \tr{
		\left(
		\prod_{t=1}^{N_t}
		e^{-\Delta \tilde{t}\tilde{K}}
		e^{-\Delta \tilde{t} (\tilde{V} - \tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
		\right)
		e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi}
	}
	+ \order{\Delta \tilde{t}^2}.
	\label{eq:fermionic generating function}
\end{align}
which we can functionally differentiate with respect to the Grassmann $\chi\adjoint$ and $\chi $ to pull down fermionic operators, and then set $\chi\adjoint, \chi \goesto 0$, just as we do for the sources $\delta\tilde{\mu}$ \eqref{functionally differentiate} and $\delta \tilde{\vec{h}}$ \eqref{dFdh factor}.
This introduces an extra fictitious timeslice into our Trotterization \eqref{trotterization bilinearized} that sources the fermion operators,
\begin{align}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t} \tilde{\mu} + \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi} }}
	\goesto
	\tr{\left(\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t} \tilde{\mu} + \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi} }\right) e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi}}.
\end{align}

We can now follow the steps in \secref{fermion matrix} but with an extra set of $\eta$s to resolve this additional `timeslice'.
\begin{align}
	\tr{\left(\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t} \tilde{\mu} + \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi} }\right) e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi}}
	=& \int \prod_{t=0}^{2N_t} d \eta^{\dagger}_t d\eta_t ~ e^{- \sum_{t}\sum_x \eta^{\dagger}_t(x) \eta_t(x)}~ \times
	\nonumber\\
	&
		\matrixElement{ -\eta_0 }{ e^{-\Delta \tilde{t}\tilde{K} }}{\eta_{2 N_t}}
		\matrixElement{ \eta_{2 N_t} }{ e^{ \tilde{\psi}\adjoint (A_{N_t} + \Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi} } }{\eta_{2 N_t-1}} ~ \times
	\nonumber\\
	&
		\cdots
	\nonumber\\
	&
		\matrixElement{ \eta_3 }{ e^{-\Delta \tilde{t}\tilde{K} }}{\eta_{2}}
		\matrixElement{ \eta_2 }{ e^{ \tilde{\psi}\adjoint (A_{1} + \Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi}} }{\eta_1} \times
	\nonumber\\
	&
		\matrixElement{ \eta_1 }{ e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi} }{ \eta_0 }
\end{align}
where the measure starts at $t=0$, one extra timeslice compared to the usual trace \eqref{coherent state trace}.
The new matrix element may be evaluated simply,
\begin{align}
	\matrixElement{ \eta_1 }{ e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi} }{ \eta_0 }
	&=
	\matrixElement{ 0 }{ e^{\eta\adjoint_1 \tilde{\psi}} e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi} e^{\tilde{\psi}\adjoint \eta_0}}{ 0 }
	\nonumber\\
	&=
	\matrixElement{ 0 }{ e^{(\eta_1+\chi)\adjoint \tilde{\psi} + \tilde{\psi}\adjoint (\eta_0 + \chi)} }{ 0 }
	=
	\bracket{\eta_1 + \chi}{\eta_0 + \chi}
	=
	e^{(\eta_1+\chi)\adjoint (\eta_0+\chi)}
\end{align}
using the coherent state definition \eqref{coherent state} and the inner product given by M\"{u}nster (4.31)~\cite{munster}.

The resulting action is close to the original Grassmann action \eqref{grassmann action}.
Incorporating the normalizing offset as in \eqref{computational partition function},
\begin{align}
	S =&
	\frac{1}{2} \sum_{\substack{ab \\ t \in [1,N_t]}} A_{at} \left[(-\Delta\tilde{t} \tilde{V})\inverse\right]_{ab} A_{bt} + \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }
+	\sum_{\substack{a \alpha \\ t \in [0, 2N_t]}} \eta\adjoint_{\alpha a t} \eta_{\alpha a t}
\nonumber\\
	&
-	\sum_{\substack{ab \alpha\alpha' \\ t\text{ even, not 0}}} \eta\adjoint_{\alpha a t+1} (-1)^{[t=2N_t]}\left[\BB\inverse\right]^{\alpha\alpha'}_{ab} \eta_{\alpha' b t}
-	\sum_{\substack{ab \alpha\alpha' \\ t\text{ odd}}}\eta\adjoint_{\alpha a\; t+1} \FF(\tilde{h})^{\alpha\alpha'}_{tab} \eta_{\alpha' b t}
\nonumber\\
	&
-	(\eta_1+\chi)\adjoint (\eta_0+\chi)
	&
	Z[\chi\adjoint, \chi] = \int DA\; D\eta\adjoint D\eta\; e^{-S}.
\end{align}
We can rewrite this action with a fermion matrix with an extra timeslice,
\begin{align}
	S =&
	\frac{1}{2} \sum_{\substack{ab \\ t \in [1,N_t]}} A_{at} \left[(-\Delta\tilde{t} \tilde{V})\inverse\right]_{ab} A_{bt} + \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }
	- \chi\adjoint \eta_0 - \eta_1\adjoint \chi - \chi\adjoint\chi
\nonumber\\
	&
	+ \begin{bmatrix} \eta_1 \\ \eta_2 \\ \vdots \\ \eta_{2N_t} \\ \eta_0 \end{bmatrix}^\dagger
	\left(
	\MM =
	\begin{bmatrix}
		\one	&	&	\cdots	&		&	-\one	\\
		-\FF_1	&	\one	&	\cdots	&	&	\\
				&	-\BB\inverse	&	\ddots	&	&	\\
				&		&	&	\one	&	\\
				&		&	&	+\BB\inverse	&	\one
	\end{bmatrix}
	\right)
	\begin{bmatrix} \eta_1 \\ \eta_2 \\ \vdots \\ \eta_{2N_t} \\ \eta_0 \end{bmatrix}
	\nonumber\\
	&
\nonumber\\
	=&
	\frac{1}{2} \sum_{\substack{ab \\ t \in [1,N_t]}} A_{at} \left[(-\Delta\tilde{t} \tilde{V})\inverse\right]_{ab} A_{bt} + \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }
	+ \eta\adjoint \MM \eta
	- \chi\adjoint \PP_0 \eta - \eta\adjoint \PP_1 \chi - \chi\adjoint\chi
\end{align}
where we define this extended fermion matrix $\MM$ and write the $\chi$-sensitive terms as talking to a timeslice projection of the full vector of $\eta$s.
Now we may complete the square, shifting
\begin{align}
	\eta &= \tilde{\eta} + \MM\inverse \PP_1 \chi
	&
	\eta\adjoint = \tilde{\eta}\adjoint + \chi\adjoint \PP_0 \MM\inverse
\end{align}
which has a Jacobian of 1, so the partition function integrating over all $\eta\adjoint$ and $\eta$ is equally well an integral over all $\tilde{\eta}\adjoint$ and $\tilde{\eta}$, which we immediately rename to be tilde-free.
This shift was carefully chosen to decouple $\eta$ and $\chi$, 
\begin{align}
	S
	=&
	\frac{1}{2} \sum_{\substack{ab \\ t \in [1,N_t]}} A_{at} \left[(-\Delta\tilde{t} \tilde{V})\inverse\right]_{ab} A_{bt} + \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }
	+ \eta\adjoint \MM \eta
	- \chi\adjoint \left(\one + \PP_0 \MM\inverse \PP_1\right)\chi;
\end{align}
(one positive $\chi\PP_0 \MM\inverse \PP_1 \chi$ comes from the $\eta\adjoint\MM\eta$ term and two negative copies come from the mixed $\eta\adjoint\chi$ and $\chi\adjoint\eta$)
so that we may now execute the fermionic gaussian integral to get
\begin{align}
	Z[\chi\adjoint, \chi]
	&=
	\int DA \det{\MM} \exp\left\{-\left(
		\frac{1}{2} \sum_{\substack{ab \\ t \in [1,N_t]}} A_{at} \left[(-\Delta\tilde{t} \tilde{V})\inverse\right]_{ab} A_{bt} + \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }
		- \chi\adjoint \left(\one + \PP_0 \MM\inverse \PP_1\right)\chi
	\right)\right\}
\end{align}
which, with malice of forethought we could have read from M\"{u}nster (4.24).
As before \eqref{sausage} we leverage the Schur complement to find $\det{\MM} = \det{\dd} = \det( \one + \UU )$.
In other words, our computational partition function \eqref{computational partition function} is exactly as before, simply with a $\chi\adjoint(\one - \PP_0 \MM\inverse \PP_1)\chi$ included,
\begin{align}
	Z[\chi\adjoint, \chi]
	&=
	\int DA\; e^{-S \text{ as in \eqref{computational partition function}}}
		e^{ \chi\adjoint \left(\one + \PP_0 \MM\inverse \PP_1\right)\chi }.
\end{align}
Now we should calculate the rather unfortunate looking $\PP_0 \MM\inverse \PP_1$.

The simplest way is to permute the (block) rows and columns of $\MM$ so that the $\eta$ vector goes $2,\, 3,\, \cdots,\, 2N_t, 0, 1$.
Then we may repeatedly use the Schur inverse formula
\begin{align}
	M
	&=
	\begin{pmatrix} A & B \\ C & D \end{pmatrix}
	&
	(M/A)
	&=
	D-CA\inverse B
	&
	M\inverse
	&=
	\begin{pmatrix}
		A\inverse + A\inverse B (M/A)\inverse C A\inverse & - A\inverse B (M/A)\inverse \\
		- (M/A)\inverse C A\inverse & (M/A)\inverse
	\end{pmatrix},
\end{align}
descending down into the lower right corner (to find the (0,1) block).
Ultimately, the $2\times2$ block structure in that corner is
\begin{align}
	\begin{bmatrix}
		\one & + \BB\inverse \FF_{N_t} \cdots \BB\inverse \FF_1
		\\
		-\one & \one
	\end{bmatrix}^{-1}
	&=
	\begin{bmatrix}
		\cdot & - \UU (\one + \UU)\inverse \\
		\cdot & \cdot
	\end{bmatrix}
\end{align}
at which point we need the upper-right block to get $\PP_0 \MM\inverse \PP_1$.
Remarkably,
\begin{align}
	\PP_0 \MM\inverse \PP_1 &= -\UU (\one+\UU)\inverse!
\end{align}
Therefore, we find
\begin{align}
	Z[\chi\adjoint, \chi]
	&=
	\int DA\; e^{-S }
		e^{ \chi\adjoint \left(\one - \UU (\one+\UU)\inverse\right)\chi }.
\end{align}

As a demonstration of how to use this expression, let us now differentiate the fermionic generating function \eqref{fermionic generating function} to try and reproduce the already-known fermionic particle number \eqref{fermionic particle number}.
As a notational convenience, let
\begin{align}
	\partial_x &= \frac{\overleftarrow{\partial}}{\partial \chi_x}
	&
	\partial\adjoint_x &= \frac{\partial}{\partial \chi\adjoint_x}
\end{align}
where $\partial_x$ acts to the left.
Then
\begin{align}
	\expectation{\tilde{n}_x}
	=
	\expectation{\tilde{\psi}\adjoint_x \tilde{\psi}_x}
	&=
	\left.\oneover{Z[\chi\adjoint, \chi]} \tr{
		\left(
		\prod_{t=1}^{N_t}
		e^{-\Delta \tilde{t}\tilde{K}}
		e^{-\Delta \tilde{t} (\tilde{V} - \tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
		\right)
		e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi}
		\tilde{\psi}\adjoint_x \tilde{\psi}_x
	}\right|_{\chi\adjoint, \chi\goesto 0}
	\nonumber\\
	&=
	\left.\oneover{Z[\chi\adjoint, \chi]} \tr{
		\left(
		\prod_{t=1}^{N_t}
		e^{-\Delta \tilde{t}\tilde{K}}
		e^{-\Delta \tilde{t} (\tilde{V} - \tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
		\right)
		e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi}
		\left(\delta_{xx} - \tilde{\psi}_x \tilde{\psi}\adjoint_x\right)
	}\right|_{\chi\adjoint, \chi\goesto 0}
	\nonumber\\
	&=
	\left. \delta_{xx} - \oneover{Z[\chi\adjoint, \chi]} \partial\adjoint_x Z[\chi\adjoint, \chi]\partial_x \right|_{\chi\adjoint, \chi\goesto0}
\end{align}
Now we replace $Z$ with the computational generating function,
\begin{align}
	\expectation{\tilde{n}_x} - \delta_{xx}
	&=
	- \oneover{Z[\chi\adjoint, \chi]} \partial\adjoint_x \left. \left(
		\int DA\; e^{-S } e^{ \chi\adjoint \left(\one - \UU (\one+\UU)\inverse\right)\chi }
	\right) \partial_x \right|_{\chi\adjoint, \chi\goesto0}
	\nonumber\\
	&=
	- \oneover{Z[\chi\adjoint, \chi]} \partial\adjoint_x \left.\left(
		\int DA\; e^{-S } e^{ \chi\adjoint \left(\one - \UU (\one+\UU)\inverse\right)\chi }
		\chi\adjoint_y (\one - \UU (\one+\UU)\inverse)_{yx}
	\right) \right|_{\chi\adjoint, \chi\goesto0}
	\nonumber\\
	&=
	- \oneover{Z[\chi\adjoint, \chi]} \Bigg(
		\int DA\; e^{-S } e^{ \chi\adjoint \left(\one - \UU (\one+\UU)\inverse\right)\chi }
		\Big[
			(\one - \UU(\one+\UU)\inverse)_{xz} \chi_z \chi\adjoint_y (\one - \UU (\one+\UU)\inverse)_{yx}
			\nonumber\\
			&\hspace{1in}
			+ (\one - \UU (\one+\UU)\inverse)_{xx}
		\Big]
	\Bigg) \Bigg|_{\chi\adjoint, \chi\goesto0}
	\nonumber\\
	&=
	- \oneover{Z} \int DA\; e^{-S }
		(\one - \UU (\one+\UU)\inverse)_{xx}
	\nonumber\\
	&=
	-\expectation{ \delta_{xx} - \left[\UU (\one+\UU)\inverse\right]_{xx}}
	\nonumber\\
	\expectation{\tilde{n}_x} &= \expectation{ \left[\UU (\one+\UU)\inverse\right]_{xx}} = \expectation{ \tr{ \left(\UU (\one+\UU)\inverse\right) \PP_x }}
\end{align}
exactly as before \eqref{fermionic particle number}!

Let us repeat the above but for generic fermion operators differentiating $\partial\adjoint_{x\sigma} \log Z[\chi\adjoint, \chi] \partial_{y\tau}$,
\begin{align}
	\oneover{Z[\chi\adjoint,\chi]} \tr{ \left(\prod_{t}
		\cdots \right)
		\tilde{\psi}_{x\sigma} e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi} \tilde{\psi}\adjoint_{y\tau}
	}
	&=
	\oneover{Z[\chi\adjoint,\chi]} \left(\int DA\; e^{-S} \left(\one - \UU (\one+\UU)\inverse \right)^{\sigma\upsilon}_{xz} \chi_{z\upsilon} e^{ \chi\adjoint \left(\one - \UU (\one+\UU)\inverse\right)\chi } \right)\partial_{y\tau}
	\nonumber\\
	\oneover{Z[\chi\adjoint,\chi]} \tr{ \left(\prod_{t}
		\cdots \right)
		\tilde{\psi}_{x\sigma} e^{\chi\adjoint \tilde{\psi} + \tilde{\psi}\adjoint \chi} \tilde{\psi}\adjoint_{y\tau}
	}
	&=
	\oneover{Z[\chi\adjoint,\chi]} \int DA\; e^{-S} \left(\one - \UU (\one+\UU)\inverse \right)^{\sigma\tau}_{xy} e^{ \chi\adjoint \left(\one - \UU (\one+\UU)\inverse\right)\chi }
	\nonumber\\
	\oneover{Z} \tr{ \left(\prod_{t}
		\cdots \right)
		\tilde{\psi}_{x\sigma} \tilde{\psi}\adjoint_{y\tau}
	}
	&=
	\oneover{Z} \int DA\; e^{-S} \left(\one - \UU (\one+\UU)\inverse \right)^{\sigma\tau}_{xy}
	\nonumber\\
	\oneover{Z} \tr{ \left(\prod_{t}
		\cdots \right)
		\left(\delta_{xy}^{\sigma\tau} - \tilde{\psi}\adjoint_{y\tau} \tilde{\psi}_{x\sigma}\right)
	}
	&=
	\oneover{Z} \int DA\; e^{-S} \left(\one - \UU (\one+\UU)\inverse \right)^{\sigma\tau}_{xy}
	\nonumber\\
	\oneover{Z} \tr{ \left(\prod_{t}
		\cdots \right)
		\tilde{\psi}\adjoint_{y\tau} \tilde{\psi}_{x\sigma}
	}
	&=
	\oneover{Z} \int DA\; e^{-S} \left[\UU (\one+\UU)\inverse \right]^{\sigma\tau}_{xy}
	\qquad\text{Note the index order!}
\end{align}
where in the third line we dropped terms that go to zero when we set the Grassmanns to zero.

The generic lesson is that we may perform Wick contractions on normal-ordered operators, replacing the contraction with the equal-time \emph{propagator} $\G$,
\begin{align}
	\contraction{}{\tilde{\psi}\adjoint_{x\sigma}}{}{\tilde{\psi}_{y\tau}}
	\tilde{\psi}\adjoint_{x\sigma}\tilde{\psi}_{y\tau}
	\goesto
	\G^{\sigma\tau}_{xy} = \left[\UU (\one+\UU)\inverse\right]_{yx}^{\tau\sigma} \qquad\text{Note the index order!}
	\label{eq:propagator}
\end{align}
as long as we track the number of minus signs that come from `crossing' in the contraction.
For an example, see the double occupancy \Secref{double occupancy}.

There is a conventional choice in defining the Fourier-space propagator: do we include factors of volume?
In the Wick contraction \eqref{propagator} both the fermion operators are in  position space, and therefore, according to our table of Fourier transforms \Tabref{ft} we should get no explicit factors of volume.
On the other hand, one of the fermions is conjugate and therefore should get an $\exp(+2\pi i k x  / N_x)$, with a $+$ sign, the sign of the transform that DOES include a $\Volume\inverse$ factor.\footnote{
	If we had settled on the unitary convention for Fourier transforms, each transform would have come with $\Volume^{-1/2}$ and there'd be no question.
}
Looking at position-space operators expressed in Fourier space, however, such as the current \eqref{current hermitian}, vorticity \eqref{vorticity}, and the vorticity correlator \eqref{vorticity-vorticity}, shows that for every pair of momentum-space fermions we get a factor of $\Volume\inverse$.
Therefore, it is natural to define
\begin{align}
	\contraction{}{\tilde{\psi}\adjoint_{k\sigma}}{}{\tilde{\psi}_{q\tau}}
	\tilde{\psi}\adjoint_{k\sigma}\tilde{\psi}_{q\tau}
	&\goesto
	\Volume \G^{\sigma\tau}_{kq} 
	&\text{or}&&
	\oneover{\Volume} 
	\contraction{}{\tilde{\psi}\adjoint_{k\sigma}}{}{\tilde{\psi}_{q\tau}}
	\tilde{\psi}\adjoint_{k\sigma}\tilde{\psi}_{q\tau}
	&\goesto
	\G^{\sigma\tau}_{kq} = \oneover{\Volume} \sum_{xy} e^{+2\pi i k x / N_x} \left(\G^{\sigma\tau}_{xy} = \left[\UU (\one+\UU)\inverse\right]_{yx}^{\tau\sigma} \right) e^{-2\pi i q y / N_x}
	\label{eq:propagator in momentum space}
\end{align}
which may be implemented via one forward and one inverse Fourier transform regardless of convention.


\subsection{The Infinite-Temperature Limit}\label{sec:infinite temperature}

One particularly simple limit is $\beta\goesto0$, where the normalized gaussian in the partition function
\begin{align}
	\lim_{\beta\goesto0} \exp\left(-\half \sum_t A_t\transpose (-\Delta\tilde{t}\tilde{V})\inverse A_t - \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }\right)
	=
	\delta( A ).
\end{align}
In other words, to evaluate infinite-temperature expectation values using our numerical setup we don't need an ensemble of configurations, but just one: the all-zero configuration.
With this simplification, we can see that the fermion matrix $\UU \goesto \one$ smoothly.
Then, the partition function
\begin{align}
	Z
	=&
	\int DA \exp\left(-\half \sum_t A_t\transpose (-\Delta\tilde{t}\tilde{V})\inverse A_t - \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }\right) \det(\one+\UU)
	\nonumber\\
	\goesto&
	\det(\one+\one) = 2^{2\Volume} = 4^\Volume
\end{align}
which counts all the possible states, and is what you expect from a direct evaluation of $\lim_{\beta\goesto0}\tr{e^{-\beta H}}$.
The simplicity of this limit can provide a good sanity check.

\subsection{Hamiltonian and Continuum Limits}\label{sec:continuum limit}

We might like to think about fixing physical parameters $M$, $a$, $L$, $\beta$, $\mu$, and $\vec{h}$, though we perform simulations with $N_x$ sites with
\begin{align}
    \tilde{a} &= \frac{2\pi a}{L} = \frac{2\pi a}{N_x \Delta x}
    &
    \tilde{\beta} &= \frac{\beta}{M L^2} = \frac{\beta}{M(\Delta x N_x)^2}
    \nonumber\\
    \tilde{\mu} &= \mu M L^2 = \mu M (\Delta x N_x)^2
    &
    \tilde{\vec{h}} &= \vec{h} M L^2 = \vec{h} ML^2 (\Delta x N_x)^2
    \\\nonumber
    \tilde{C}_0 &
        = - \frac{2\pi}{\log \frac{2\pi a}{\Delta x} - \frac{2}{\pi} G}
        = - \frac{2\pi}{\log (\tilde{a} N_x) - \frac{2}{\pi} G}
    &
    (\Delta x &= L/N_x)
\end{align}
and $N_t$ timeslices discretizing $\Delta\tilde{t} = \tilde{\beta}/N_t$.
For all quantities above we write, when possible, expressions that make it clear how the continuum limit and infinite lattice limits are taken.
A partition function with physical parameters is estimated by a particular lattice partition function
\begin{align}
    Z\left(M, a, L, \beta, \mu, \vec{h}\right) \approx Z\left(\tilde{a} = \frac{2\pi a}{L}, \tilde{\beta} = \frac{\beta}{ML^2}, \tilde{\mu} = \mu ML^2, \tilde{\vec{h}} = \vec{h}ML^2, N_x, N_t \right)
\end{align}
where we do not write the dependence on $\tilde{C}$, which is a function of $\tilde{a}$ and $N_x$ only.

The \emph{Hamiltonian limit} is the limit in which $N_t\goesto\infty$ holding $\tilde{a}$, $\tilde{\beta}$, $\tilde{\mu}$, and $\tilde{h}$ fixed, so that the Trotterization error disappears,
\begin{align}
    \lim_{N_t\goesto\infty} Z(\tilde{a}, \tilde{\beta}, \tilde{\mu}, \tilde{\vec{h}}, N_x, N_t)
    =
    Z(\tilde{a}, \tilde{\beta}, \tilde{\mu}, \tilde{\vec{h}}, N_x)
    \label{eq:hamiltonian limit}
\end{align}
From our careful tracking of the Trotterization \eqref{trotterization} things should go to their time-continuum values with $\Delta{\tilde{t}}^2 \sim N_t^{-2}$.
This limit is particularly easy to understand as none of the above dimensionless simulation parameters depend on $N_t$; it should be taken first.

The \emph{continuum limit} holds the physical parameters fixed and sends $N_x \goesto \infty$ as $\Delta x\goesto 0$ so that $L=N_x \Delta x$ is fixed.
Since $\tilde{a}$ is fixed but $N_x$ increases, $\tilde{C}_0$ decreases.
\begin{align}
    \lim_{N_x\goesto\infty} Z(\tilde{a}, \tilde{\beta}, \tilde{\mu}, \tilde{\vec{h}}, N_x) = Z(\tilde{a}, \tilde{\beta}, \tilde{\mu}, \tilde{\vec{h}})
\end{align}
which demonstrates that the six-parameter partition function is only truly a function of four parameters.
Since in a non-relativistic theory mass dimensions count separately from length, and we only have one mass scale, we already knew that $M$ could be scaled out.
However, that would leave 5 parameters, not 4.
The further reduction is a repercussion of the magic in \Secref{magic}.

\subsection{Infinite Volume and Zero-Temperature Limits}\label{sec:thermodynamic limit}

Other limits are a bit more delicate, as the dimensionless simulation parameters required may vary with $N_x$ or $\Delta x$.
To simplify the other limits of interest we trade $\mu$ and $\vec{h}$ for fugacities,
\begin{align}
    \log z &= \beta \mu = \tilde{\beta} \tilde{\mu} = \log \tilde{z}
    &
    \widevec{\log z_h} &= \beta \vec{h} = \tilde{\beta}\tilde{\vec{h}} = \widevec{\log \tilde{z}_h}
\end{align}
(the vector goes outside of the log to indicate how rotational transformations act).
What's nice about $\log \tilde{z}$ and $\log \tilde{z}_h$ is that they take the same values no matter $L$; they're intrinsic, dimensionless, and scale-independent, free from $N_x$ or $\Delta x$.

The \emph{zero temperature} and \emph{infinite volume} limits are tricky to disentangle, exactly because, by magic, there are fewer parameters than we need to make independent adjustments.
Suppose you take the infinite volume limit first, holding physical $a$, $\beta$, $\mu$, and $\vec{h}$ fixed.
Given the functional dependence of the dimensionless parameters on $L$, the infinite volume limit leaves
\begin{align}
    \frac{\tilde{\beta}}{\tilde{a}^2} = \frac{\beta}{(2\pi a)^2 M}
\end{align}
fixed.
Therefore the resulting partition function is
\begin{align}
    \lim_{L\goesto\infty} Z(\tilde{a}, \tilde{\beta}, \log\tilde{z}, \widevec{\log \tilde{z}_h})
    =
    Z\left(
        \tilde{\beta}\tilde{a}^{-2} = \frac{\beta}{(2\pi a)^2 M},
        \log\tilde{z} = \beta \mu,
        \widevec{\log \tilde{z}_h} = \beta \vec{h}
        \right)
    \label{eq:infinite volume}
\end{align}

Now we may take the zero-temperature limit $\beta\goesto\infty$.
All three remaining dimensionless parameters diverge together, in proportion.
The result is therefore
\begin{align}
    \lim_{\beta\goesto\infty} Z(\tilde{\beta}\tilde{a}^{-2}, \log\tilde{z}, \widevec{\log \tilde{z}_h})
    =
    Z\left( \tilde{a}^2\tilde{\mu} = (2\pi a)^2 M \mu, \tilde{a}^2 \tilde{\vec{h}} = (2\pi a)^2 M \vec{h} \right).
    \label{eq:volume then temperature}
\end{align}
If we start with $\mu=0$ and $\vec{h}=0$, the result is universal, independent of $a$!

We should carefully consider how observables go to these limits.

What if we take the zero-temperature limit before the infinite volume?
Then $\tilde{\beta}$, $\log\tilde{z}$ and $\widevec{\log\tilde{z}_h}$ diverge in proportion, and 
\begin{align}
    \lim_{\beta\goesto0} Z(\tilde{a}, \tilde{\beta}, \log\tilde{z}, \widevec{\log \tilde{z}_h})
    =
    Z(\tilde{a}, \tilde{\mu}, \tilde{\vec{h}})
\end{align}
since the chemical potential and external fields are left fixed even as their respective fugacities diverge.
If we now take the infinite-volume limit $L\goesto\infty$ we wind up with a function of the same arguments as before,
\begin{align}
    \lim_{L\goesto\infty}
    Z(\tilde{a}, \tilde{\mu}, \tilde{\vec{h}})
    =
    Z( \tilde{a}^2\tilde{\mu}, \tilde{a}^2 \tilde{\vec{h}} )
    \label{eq:temperature then volume}
\end{align}
though whether the zero-temperature and infinite-volume limits commute is not demonstrated here, or known to me.
In other words, the two partition functions \eqref{volume then temperature} and \eqref{temperature then volume} might differ, though it seems plausible to me that they should be equal when $\mu$ and $\vec{h}$ vanish at the very least.

\subsection{The Infinite-Lattice limit}

We also may take another route and consider the \emph{infinite lattice limit} after the Hamiltonian limit \eqref{hamiltonian limit}, holding $a$ and $\Delta x$ fixed and sending $L$ and $N_x$ to infinity together, a sort of infinite volume limit; imagine a very large square crystal.
Dimensionless $\log \tilde{z}$ and $\widevec{\log \tilde{z}_h}$ stay fixed.
While $\tilde{\beta}$ goes to zero like $N_x^{-2}$, $\tilde{a}$ goes like $N_x^{-1}$ and $\tilde{C}_0$ remains fixed (which distinguishes it the usual infinite-volume limit, executed after the continuum limit),
\begin{align}
    \lim_{\text{infinite lattice}} Z(\tilde{a}, \tilde{\beta}, \log\tilde{z}, \widevec{\log\tilde{z}_h}, N_x) 
    =
    Z(\tilde{\beta}\tilde{a}^{-2}, \log\tilde{z}, \widevec{\log\tilde{z}_h}, \tilde{C}_0)
\end{align}
This seemingly has a well-defined continuum limit: just send $\tilde{C}_0$ to zero along the tuning, as expected, holding $a$ fixed and sending $\Delta x\goesto 0$.
An important question for practical purposes is: is the resulting function the same as the usual continuum-first infinite-volume limit \eqref{infinite volume}?
If so we can perform simultaneous extrapolations, for example, and the zero temperature limit will follow as above.
