\section{Partition Function}

We wish to compute observables with the partition function
\begin{align}
	Z
	&=
	\tr{e^{-\beta(H-\mu N - \vec{h}\cdot\vec{S})}}
	&
	N &= \int d^2x\; \psi\adjoint(x)\psi(x)
	&
	\vec{S} = \half \int d^2x\; \psi\adjoint(x) ~ \vec{\sigma} ~ \psi(x)
\end{align}
where $N$ is the total number operator and $\vec{S}$ are spin operators which obey $[S^i, S^j] = i\epsilon^{ijk} S^k$.
In the latticized language 
\begin{align}
	N
	&\goesto
	\sum_x \Delta x^2 \psi\adjoint_x \psi_x
	=
	\sum_a \tilde{\psi}\adjoint_a \tilde{\psi}_a
	=
	\sum_a \tilde{n}_a
	=
	\tilde{N}
	\\
	\vec{S}
	&\goesto
	\half \sum_x \Delta x^2 \psi\adjoint_x \vec{\sigma} \psi_x
	=
	\half \sum_a \tilde{\psi}\adjoint_a ~ \vec{\sigma} ~ \tilde{\psi}_a
	=
	\tilde{\vec{S}}
\end{align}
\emph{with no powers of $\Delta x$ required}.
Explicitly, the local spin operators are
\begin{align}
	\tilde{S}^1 &= \half \left(\tilde{\psi}\adjoint_\uparrow \tilde{\psi}_\downarrow + \tilde{\psi}\adjoint_\downarrow \tilde{\psi}_\uparrow\right)
	&
	\tilde{S}^2 &= \frac{i}{2} \left( \tilde{\psi}\adjoint_\downarrow \tilde{\psi}_\uparrow - \tilde{\psi}\adjoint_\uparrow \tilde{\psi}_\downarrow\right)
	&
	\tilde{S}^3 &= \half \left(\tilde{\psi}\adjoint_\uparrow \tilde{\psi}_\uparrow - \tilde{\psi}\adjoint_\downarrow \tilde{\psi}_\downarrow\right).
\end{align}
We can isolate the dimensionful quantities
\begin{align}
	Z
	&=
	\tr{e^{-\left(\frac{\beta}{M\Delta x^2}\right)(HM\Delta x^2 -M \Delta x^2 \mu N - M \Delta x^2 \vec{h} \cdot \vec{S})}}
\\
	&=
	\tr{e^{-\tilde{\beta}(\tilde{K}+\tilde{V}-\tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})}}
	&
	\tilde{\beta} &= \frac{\beta}{M \Delta x^2}
	&
	\tilde{\mu}   &= M \Delta x^2 \mu
	&
	\tilde{\vec{h}} &= M \Delta x^2 \vec{h}
	\label{eq:dimensionless}
\end{align}
where $\tilde{\beta}$, $\tilde{\mu}$, and $\tilde{\vec{h}}$ are dimensionless, and $\tilde{K}$ and $\tilde{V}$ are the dimensionless kinetic and potential operators in the dimensionless Hamiltonian \eqref{dimensionless hamiltonian}.

Let us Trotterize $\tilde{\beta}$ into $N_t$ time slices so that $\Delta \tilde{t} = \tilde{\beta}/N_t = \beta/M \Delta x^2 N_t$, which exactly matches $\hat{\gamma}$ in our prior work.
We begin with the identity
\begin{equation}
	e^{-\Delta \tilde{t}(\tilde{H} - \tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})}
	=
	e^{-\Delta \tilde{t}\tilde{K} / 2}
	e^{-\Delta \tilde{t} (\tilde{V} - \tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
	e^{-\Delta \tilde{t}\tilde{K} / 2}
	+
	\mathcal{O}(\Delta \tilde{t}^3) 
\end{equation}
where $\tilde{H} = \tilde{K} + \tilde{V}$ has been decomposed into the kinetic energy $\tilde{K}$ and the interaction term $\tilde{V}$ as in \eqref{dimensionless hamiltonian}.
Therefore,
\begin{align}
	\tr{e^{-\tilde{\beta}(\tilde{H}-\tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}}
	=
	\tr{
		\prod_{t=1}^{N_t}
		e^{-\Delta \tilde{t} (\tilde{H}-\tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
	}
	&=
	\tr{
		\prod_{t=1}^{N_t}
		e^{-\Delta \tilde{t}\tilde{K} / 2}
		e^{-\Delta \tilde{t} (\tilde{V} - \tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
		e^{-\Delta \tilde{t}\tilde{K} / 2}
	}
	+ \order{\Delta \tilde{t}^2}
	\nonumber\\
	&=
	\tr{
		\prod_{t=1}^{N_t}
		e^{-\Delta \tilde{t}\tilde{K}}
		e^{-\Delta \tilde{t} (\tilde{V} - \tilde{\mu} \tilde{N} - \tilde{\vec{h}}\cdot \tilde{\vec{S}})}
	}
	+ \order{\Delta \tilde{t}^2}.
	\label{eq:trotterization}
\end{align}
which converges to the desired thermal trace as $\Delta \tilde{t} \goesto 0$.

We now begin a sequence of exact manipulations of the Trotterization \eqref{trotterization}.
Recall that the potential operator can be expressed as a sum of Lego spheres \eqref{dimensionless hamiltonian},
\begin{align}
	\tilde{V}
	&= \frac{1}{2} \sum_{ab} \tilde{n}_a \tilde{V}_{ab} \tilde{n}_b
	&
	\tilde{V}_{ab}
	&=
	\sum_{\vec{R}} \tilde{C}_{\vec{R}} \LegoSphere{\vec{R}}_{ab}
\end{align}
where $\tilde{V}_{ab}$ is a symmetric matrix and the radii $\vec{R}$ can be chosen however we like.
If $\tilde{V}$ has purely real negative eigenvalues (which imposes conditions on the bare coupling constants), then the following \emph{exact} Hubbard-Stratanovich transformation holds:
\begin{equation}
	\exp\left( \frac{1}{2} \sum_{ab}\tilde{n}_a \left(-\Delta\tilde{t} \tilde{V}\right)_{ab} \tilde{n}_b + \Delta \tilde{t} \tilde{\mu}\tilde{N} + \Delta\tilde{t} \tilde{\vec{h}}\cdot\tilde{\vec{S}}\right)
	=
	\frac{
		\int dA\; e^{-\frac{1}{2} A\transpose (-\Delta\tilde{t} \tilde{V})\inverse A + \tilde{\psi}\adjoint (A + \Delta\tilde{t} \tilde{\mu} + \half \Delta\tilde{t} \tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi}}
	}{
		\int dA\; e^{-\frac{1}{2} A\transpose (-\Delta\tilde{t} \tilde{V})\inverse A}
	}
\end{equation}
where $A$ is a vector with $\Volume$ components but the $\mu$ and $h$ terms are spatial constants and the fermionic term is implicitly summed over space.
So, we have the \emph{exact} rewriting of the Trotterized partition function \eqref{trotterization}
\begin{equation}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{-\Delta \tilde{t}(\tilde{V} - \tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})} }
	= 
	\frac{  
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}
	~	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t} \tilde{\mu} + \half \Delta\tilde{t} \tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi}} } 
	}{ 
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}
	}
	\label{eq:trotterization bilinearized}
\end{equation}
where $DA = \prod_{t=1}^{N_t} d A_t $.\footnote{
	We choose to group the chemical potential term with $V$ rather than $K$.
	The main reason is that both $N$ and $V$ are formed from products of local densities which commute $[\tilde{n}_{\sigma}(x),\tilde{n}_{\sigma'}(x')] = 0$, and therefore functional derivatives are simple:
	\begin{align*}
		-\frac{1}{\Delta t} \frac{\partial}{\partial \mu_{\sigma 'a'}}\exp\left( V - \Delta t \sum_{\sigma a}\mu_{\sigma a} n_{\sigma a}\right) 
		&
		=  n_{\sigma' a'} \exp\left( V - \Delta t \sum_{\sigma a}\mu_{\sigma a} n_{\sigma a}\right)
		= \exp\left( V - \Delta t \sum_{\sigma a}\mu_{\sigma a} n_{\sigma a}\right) n_{\sigma' a'}~.
	\end{align*} 
	This property allows us to compute density correlation functions with ease.
	However, the simple ``pulling down" of operators by derivatives occurs \emph{only if the argument of the exponential and its derivative commute}~\cite{10.2307/4146900}.
	If we were to instead group the chemical potential terms with $K$, functional derivatives cease to be simple because $[K,n_{\sigma}(x)] \neq 0$.
}

\subsection{The Fermion Matrix}\label{sec:fermion matrix}

Using fermion coherent states, we will now convert the trace over the Hilbert space into a determinant.
Using the conventions of Munster Ch. 4,
\begin{align}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t} \tilde{\mu} + \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi} }}
	=& \int \prod_{t=1}^{2N_t} d \eta^{\dagger}_t d\eta_t ~ e^{- \sum_{t}^{N_t}\sum_x \eta^{\dagger}_t(x) \eta_t(x)}~ \times
	\nonumber\\
	&
		\matrixElement{ -\eta_1 }{ e^{-\Delta \tilde{t}\tilde{K} }}{\eta_{2 N_t}}
		\matrixElement{ \eta_{2 N_t} }{ e^{ \tilde{\psi}\adjoint (A_{N_t} + \Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi} } }{\eta_{2 N_t-1}} ~ \times
	\nonumber\\
	&
		\cdots
	\nonumber\\
	&
		\matrixElement{ \eta_5 }{ e^{-\Delta \tilde{t}\tilde{K} }}{\eta_{4}}
		\matrixElement{ \eta_4 }{ e^{ \tilde{\psi}\adjoint (A_{2} + \Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi}} }{\eta_3} ~ \times
	\nonumber\\
	&
		\matrixElement{ \eta_3 }{ e^{-\Delta \tilde{t}\tilde{K} }}{\eta_{2}}
		\matrixElement{ \eta_2 }{ e^{ \tilde{\psi}\adjoint (A_{1} + \Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi}} }{\eta_1}
\end{align}
where the coherent states
\begin{equation*}
	\ket{\eta_t} = \exp\left( \sum_{\sigma a} \tilde{\psi}^{\dagger}_{\sigma a} \eta_{\sigma a t} \right) \ket{0}
\end{equation*}
are spatial vectors and spin doublets on a single timeslice.
To proceed we leverage the exponential identity (4.33) of Munster,
\begin{equation}
	\matrixElement{ \eta }{ e^{\sum_{ij} \psi^{\dagger}_j A_{ji} \psi_i} }{ \eta' }
	=
	\exp\left[ \sum_{i j} \eta^{\dagger}_j (e^A)_{ji} \eta'_i \right]
\end{equation}
to carefully evaluate $\matrixElement{\eta}{ e^{-\Delta \tilde{t}\tilde{K}} }{\eta'}$ and $\matrixElement{\eta}{ e^{\tilde{\psi}\adjoint(A_t + \Delta \tilde{t} \tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi}} }{\eta'}$, keeping careful track of the spin degree of freedom,
\begin{align}
		\matrixElement{\eta}{ e^{-\Delta \tilde{t} \tilde{K}} }{\eta'}
	&= 
		\matrixElement{\eta}{ \exp\left(-\Delta \tilde{t} \sum_{ab \sigma} \tilde{\psi}^{\dagger}_{\sigma a} \tilde{\kappa}_{ab} \tilde{\psi}_{\sigma b} \right)}{\eta'}
	\nonumber\\
	&=
		\matrixElement{\eta}{ \exp\left(
			\begin{bmatrix} \tilde{\psi}^{\dagger}_{\up} &  \tilde{\psi}^{\dagger}_{\down}  \end{bmatrix} 
			\begin{bmatrix}
				-\Delta \tilde{t} \tilde{\kappa}	& 0 \\
				0 									& -\Delta \tilde{t} \tilde{\kappa} 
			\end{bmatrix} 
			\begin{bmatrix} \tilde{\psi}_{\up} \\  \tilde{\psi}_{\down}  \end{bmatrix}
		\right) }{\eta'}
	\nonumber\\
	& = 
		\exp\left( 
			\begin{bmatrix} {\eta}^{\dagger}_{\up} &  {\eta}^{\dagger}_{\down}  \end{bmatrix} 
			\exp\begin{pmatrix}
				-\Delta \tilde{t} \tilde{\kappa}	& 0 \\
				0 									& -\Delta \tilde{t} \tilde{\kappa} 
			\end{pmatrix} 
			\begin{bmatrix} {\eta}_{\up}' \\  {\eta}_{\down}'  \end{bmatrix}
		\right)
\end{align}
where $\tilde{\kappa}$ is given in the dimensionless Hamiltonian \eqref{dimensionless hamiltonian} \todo{and includes the C0 shift!}.
By an analogous sequence of manipulations, one also finds
\begin{align}
	\matrixElement{\eta}{ e^{\tilde{\psi}\adjoint \cdot (A_t + \Delta\tilde{t} \tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi}} }{\eta'}
	&=
		\matrixElement{\eta}{ \exp\left(
			\begin{bmatrix} \tilde{\psi}^{\dagger}_{\up} &  \tilde{\psi}^{\dagger}_{\down}  \end{bmatrix} 
			\left(
				(A + \Delta\tilde{t}\tilde{\mu})\one + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}
			\right)
			\begin{bmatrix} \tilde{\psi}_{\up} \\  \tilde{\psi}_{\down}  \end{bmatrix}
		\right) }{\eta'}
	\label{eq:gaussian spinors}\\
	& = 
		\exp\left(
			\begin{bmatrix} \eta^{\dagger}_{\up} &  \eta^{\dagger}_{\down}  \end{bmatrix} 
			\exp\left(
				(A + \Delta\tilde{t}\tilde{\mu})\one + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}
			\right)
			\begin{bmatrix} \eta'_{\up} \\  \eta'_{\down}  \end{bmatrix}
		\right)
\end{align}
where the inner exponential is space-dependent through $A$.
So, we can rewrite the Hilbert space trace in the bilinearized Trotterization \eqref{trotterization bilinearized}
\begin{align}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t} \tilde{\mu} + \half \Delta\tilde{t} \tilde{\vec{h}}\cdot\vec{\sigma})\tilde{\psi}} }
	=& \int D\eta\adjoint D\eta \exp\left( - \sum_{t=1}^{2N_t}\sum_{a\sigma} \eta\adjoint_{\sigma a t} \eta_{\sigma a t}\right)~ \times
	\nonumber\\
	&
		\exp\left[ \sum_{ab\sigma} (-\eta_{\sigma a\;1})\adjoint \left(e^{-\Delta \tilde{t} \tilde{\kappa}}\right)_{ab} \eta_{\sigma b\;2N_t} \right]
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;2N_t} \left(e^{A_{N_t}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma} }\right)_{ab}^{\sigma\sigma'} \eta_{\sigma' b\;2N_t-1}\right] ~ \times
	\nonumber\\
	&
		\cdots
	\nonumber\\
	&
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;5} \left(e^{-\Delta \tilde{t} \tilde{\kappa}}\right)_{ab} \eta_{\sigma b\;4} \right]
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;4} \left(e^{A_{2}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}}\right)_{ab}^{\sigma\sigma'} \eta_{\sigma' b\;3}\right] ~ \times
	\nonumber\\
	&
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;3} \left(e^{-\Delta \tilde{t} \tilde{\kappa}}\right)_{ab} \eta_{\sigma b\;2} \right]
		\exp\left[ \sum_{ab\sigma} \eta\adjoint_{\sigma a\;2} \left(e^{A_{1}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}}\right)_{ab}^{\sigma\sigma'} \eta_{\sigma' b\;1}\right]
	\label{eq:grassmann integral}
\end{align}
where the measure is given by
\begin{equation}
	D\eta\adjoint D\eta \equiv \prod_{t=1}^{2N_t} \left\{ \prod_{a, \sigma} d \eta^{\dagger}_{\sigma a\; t} d\eta_{\sigma a\; t} \right\}.
\end{equation}
Written with the Grassmann fields the action is
\begin{align}
	S &= 
	\frac{1}{2} \sum_{ab t} A_{at} \left[(-\Delta\tilde{t} \tilde{V})\inverse\right]_{ab} A_{bt}
+	\sum_{ab t \alpha\alpha'} \eta\adjoint_{\alpha a t} \BB^{\alpha\alpha'}_{ab} \eta_{\alpha' b t}
-	\sum_{ab t \alpha\alpha'}\eta\adjoint_{\alpha a\; t+1} \FF(\tilde{h})^{\alpha\alpha'}_{tab} \eta_{\alpha' b t}
\nonumber\\
	&=
	\frac{1}{2} \sum_{ab t} A_{at} \left[(-\Delta\tilde{t} \tilde{V})\inverse\right]_{ab} A_{bt}
+	\sum_{ab t \alpha} \eta\adjoint_{\alpha a t} B_{ab} \eta_{\alpha b t}
-	\sum_{a t \alpha\alpha'}\eta\adjoint_{\alpha a\; t+1} \FF(\tilde{h})^{\alpha\alpha'}_{ta} \eta_{\alpha' a t}
\end{align}
where we leverage the fact that the hopping in $\BB$ does not mix spins and $\FF$ does not mix sites.

Performing the Grassmannian integration yields a fermion determinant,
\begin{align}
	\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}} e^{ \tilde{\psi}\adjoint (A_t + \Delta\tilde{t}\tilde{\mu} + \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}) \tilde{\psi}} }
	=
	\int D\eta\adjoint D\eta ~ e^{- \eta^{\dagger} ~ \DD ~ \eta} = \det \DD
	\label{eq:fermion determinant with 2nt timeslices}
\end{align}
where $\DD$ is $(2N_t)\times(\Volume)\times(2\text{ spins})$ on a side.
Writing
\begin{align}
	\BB &= B \otimes \one
	&
	B &= \exp \Delta\tilde{t} \tilde{\kappa}
	\label{eq:BB}\\
	\FF_t &= \left(e^{A_{t}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}}\right)
	\label{eq:FF}
\end{align}
where the doubly-struck quantities are also square matrices in spin dimensions; the hopping matrix is time-independent and spin-diagonal, $\FF$ is space-diagonal.
Using this notation we can write the Fermion matrix as
\begin{align}
	\DD = \begin{bmatrix} 
			\one            & 0         & 0                 & 0         & 0      & \cdots & 0       & 0                     & +\BB^{-1}
		\\	-\FF_1(\tilde{h}) & \one      & 0                 & 0         & 0      & \cdots & 0       & 0                     & 0
		\\	0               & -\BB^{-1}   & \one              & 0         & 0      & \cdots & 0       & 0                     & 0
		\\	0               & 0         & -\FF_2(\tilde{h})   & \one      & 0      & \cdots & 0       & 0                     & 0
		\\	0               & 0         & 0                 & -\BB^{-1}   & \one   & \cdots & 0       & 0                     & 0
		\\	\vdots          & \vdots    & \vdots            & \vdots    & \vdots & \ddots & \vdots  & \vdots                & \vdots
		\\	0               & 0         & 0                 & 0         & 0      & \cdots & -\BB^{-1} & \one                  & 0
		\\	0               & 0         & 0                 & 0         & 0      & \cdots & 0       & -\FF_{N_t}(\tilde{h})   & \one
	\end{bmatrix}.
	\label{eq:DD}
\end{align}
The determinant of $\DD$ is equal to the determinant
\begin{align}
    \dd'
	=
	\begin{bmatrix}
			\BB                  & 0                             & 0                             & 0             & \cdots & 0                                & +\FF_{N_t}(\tilde{h})
		\\	-\FF_{1}(\tilde{h})  & \BB                    & 0                             & 0             & \cdots & 0                                & 0
		\\	0                           & -\FF_{2}(\tilde{h})    & \BB                    & 0             & \cdots & 0                                & 0
		\\	0                           & 0                             & -\FF_{3}(\tilde{h})    & \BB    & \cdots & 0                                & 0
		\\	\vdots                      & \vdots                        & \vdots                        & \vdots        & \ddots & \vdots                           & \vdots
		\\	0                           & 0                             & 0                             & 0             & \cdots & \BB                       & 0
		\\	0                           & 0                             & 0                             & 0             & \cdots & -\FF_{N_t-1}(\tilde{h})   & \BB
	\end{bmatrix},
\end{align}
up to a constant
\begin{align}
    \det \DD = \frac{ \det \dd' }{ \det \BB^{N_t} } = \frac{ \det \dd' }{ \det \exp 2 \tilde{\beta}\tilde{\kappa} }
\end{align}
and we can write the $\det \dd'$ in terms of a `block sausage'.

However, we will show that it is advantageous to multiply by $-\BB\inverse \otimes \one_{N_t}$ to get
\begin{align}
    \dd
	=
	\begin{bmatrix}
			-\one                           & 0                                 & 0                                 & 0         & \cdots & 0                                    & -\BB\inverse\FF_{N_t}(\tilde{h})
		\\	+\BB\inverse\FF_{1}(\tilde{h})  & -\one                             & 0                                 & 0         & \cdots & 0                                    & 0
		\\	0                               & +\BB\inverse\FF_{2}(\tilde{h})    & -\one                             & 0         & \cdots & 0                                    & 0
		\\	0                               & 0                                 & +\BB\inverse\FF_{3}(\tilde{h})    & -\one     & \cdots & 0                                    & 0
		\\	\vdots                          & \vdots                            & \vdots                            & \vdots    & \ddots & \vdots                               & \vdots
		\\	0                               & 0                                 & 0                                 & 0         & \cdots & -\one                                & 0
		\\	0                               & 0                                 & 0                                 & 0         & \cdots & +\BB\inverse\FF_{N_t-1}(\tilde{h})   & -\one
	\end{bmatrix},
	\label{eq:fermion matrix}
\end{align}
or in index notation (letting $\delta_{1,N_t+1}=1$)
\begin{align}
	\dd_{\alpha a t, \alpha' a' t'} &= (-1)^{[t'=N_t]} [\BB\inverse]^{\alpha\alpha''}_{aa''}\FF_{t' a''a'}^{\alpha''\alpha'} \delta_{t,t'+1} - \delta_{\alpha\alpha'} \delta_{aa'} \delta_{tt'}
	\\
	&= (-1)^{[t'=N_t]} [B\inverse]_{aa''}\FF_{t' a''a'}^{\alpha'\alpha'} \delta_{t,t'+1} - \delta_{\alpha\alpha'} \delta_{aa'} \delta_{tt'}
\end{align}
which actually has $\det \DD = \det \dd$ and the way the sausage appears is apparent.
Using the Shur complement, one has
\begin{align}
	\det \dd &= \det\left( \one + \UU \right)
	&
	\UU = \BB\inverse \FF_{N_t} \cdots \BB\inverse \FF_{2} \BB\inverse \FF_1.
	\label{eq:sausage}
\end{align}
The sausage $\UU$ is (2 spins)$\times \Volume$ on a side.
Note that we can separate
\begin{align} 
	\FF_t 
	= e^{A_{t}+\Delta\tilde{t}\tilde{\mu} + \half \Delta\tilde{t}\tilde{\vec{h}}\cdot\vec{\sigma}}
	= e^{A_t + \Delta\tilde{t}\tilde{\mu}}\left( \cosh \half \Delta\tilde{t} \abs{\tilde{h}} \one + \frac{\tilde{\vec{h}}\cdot \sigma}{\abs{\tilde{h}}}\sinh \half \Delta\tilde{t} \abs{\tilde{h}} \right)
	\label{eq:FF explicitly}
\end{align}
into a space-dependent part $e^{A_t}$, a spin-dependent part $\exp( \Delta\tilde{t}\tilde{\vec{h}} \cdot \vec{\sigma})$ and the spin- and space- independent $\mu$ piece.
We can collect the space-independent part, pulling them through the sausage,
\begin{align}
	\UU 
	&= \exp\left(\half \Delta\tilde{t} \tilde{\vec{h}}\cdot\vec{\sigma}\right)^{N_t} \BB\inverse (e^{A_{N_t} + \Delta\tilde{t}\tilde{\mu}} \otimes\one)\cdots \BB\inverse (e^{A_2 + \Delta\tilde{t}\tilde{\mu}}\otimes\one) \BB\inverse (e^{A_1 + \Delta\tilde{t}\tilde{\mu}}\otimes \one)
	\\
	&= \exp\left(\half \tilde{\beta}\tilde{\vec{h}}\cdot\vec{\sigma}\right) \begin{pmatrix} zU & 0 \\ 0 & zU \end{pmatrix}
	&
	z &= \exp(\tilde{\beta} \tilde{\mu})
	\label{eq:fugacity}\\
	U &= B\inverse e^{A_{N_t}} \cdots B\inverse e^{A_2} B\inverse e^{A_1}
\end{align}
where $z$ is the fugacity.
Note that the fugacity can be computed directly from the dimensionful parameters; $z=\exp(\tilde{\beta}\tilde{\mu})=\exp(\beta\mu)$, using the dimensionless definitions \eqref{dimensionless}.
Similarly, the external field parameter matches, $\tilde{\beta}\tilde{\vec{h}} = \beta \vec{h}$.

We immediately see that if $\tilde{\vec{h}} = 0$ the spin sectors yield the same determinant, $\det\dd = \det (1+zU)^2$.
Therefore, when $\tilde{h}=0$ the fermion determinant $\det\dd$ is positive semidefinite.

Moreover, since the $2\times2$ $U$ block matrix is spin-independent, for evaluating the fermion determinant we can always rotate by some $O$ that operates only in spin space and diagonalizes $\tilde{\vec{h}}\cdot\vec{\sigma}$,
\begin{align}
	\det \dd 
	= \det(\one+\UU)
	&= \det\left(\one + e^{\half \tilde{\beta} \tilde{\vec{h}}\cdot\vec{\sigma}}(zU\otimes\one)\right)
	= \det\left(\one + O\inverse O e^{\half \tilde{\beta} \tilde{\vec{h}}\cdot\vec{\sigma}} (zU\otimes\one)\right)
	\nonumber\\
	&= \det\left(\one + O e^{\half \tilde{\beta} \tilde{\vec{h}}\cdot\vec{\sigma}} (zU\otimes\one)O\inverse \right)
	= \det\left(\one + O e^{\half \tilde{\beta} \tilde{\vec{h}}\cdot\vec{\sigma}} O\inverse (zU\otimes\one) \right)
	\nonumber\\
	&= \det\left(\one + e^{\half \tilde{\beta} \abs{\tilde{h}} \sigma_3 } (zU\otimes\one) \right)
	\\
	&= \det\left( 1 + e^{+\half \tilde{\beta}\abs{\tilde{h}}} zU\right)\det\left( 1 + e^{-\half \tilde{\beta}\abs{\tilde{h}}} zU\right)
	\label{eq:finite-h determinant algorithm}
\end{align}
which means that to evaluate the fermion determinant for any $\tilde{h}$ we can always evaluate an equivalent expression with just $\vec{\tilde{h}}\parallel\hat{z}$.
So, any external magnetic field of the same magnitude causes the same difficulty in sign problem.

\subsection{The Auxiliary-Field Action}

Now we may write a computationally-tractable expression for the partition function as a statistical system of classical auxiliary fields.
Starting with the bilinear \eqref{trotterization bilinearized} we can now replace the Hilbert space trace with the first-pass fermion determinant \eqref{fermion determinant with 2nt timeslices} and trade that for the determinant of the preferable fermion matrix \eqref{sausage},
\begin{align}
	Z=\tr{\prod_{t=1}^{N_t} e^{-\Delta \tilde{t}\tilde{K}}  e^{-\Delta \tilde{t}(\tilde{V} - \tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})} }
	= 
	\frac{  
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}
	~	\left(\det \DD = \det \dd = \det \one + \UU \right)
	}{ 
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}
	}.
\end{align}
When $\vec{h}\neq 0$ we may use single-species sausage $U$ and reuse it for each spin to compute the determinant \eqref{finite-h determinant algorithm}.
When $\vec{h} = 0$ it is even simpler; as that determinant is a square.
However, in that case it may prove beneficial to use pseudofermions to stochastically estimate the determinant.

The denominator may be evaluated exactly.
For each timeslice we get $(\det -2\pi \Delta\tilde{t} \tilde{V})^{1/2}$.
Therefore
\begin{align}
	\left[\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t}\right]\inverse
	=
	(\det -2\pi \Delta\tilde{t} \tilde{V})^{-N_t/2}
	=
	\exp\left[ -\frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t} \tilde{V}} \right].
\end{align}

Throwing the determinant up into the action we arrive at
\begin{align}
	S &= \half \sum_t A_t\transpose (-\Delta\tilde{t}\tilde{V})\inverse A_t - \log\det(\one+\UU) + \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }
	&
	Z &= \int DA\; e^{-S}.
	\label{eq:computational partition function}
\end{align}
where we even have tracked the usually-irrelevant constant.

\subsection{Fermion Matrix Eigenvectors}

The advantage of this fermion matrix is the identity matrix appearing on the diagonal, which allows us to easily generate $N_t$ eigenvectors of $\dd$, as follows.

Suppose we have an eigenvector $u_{\alpha' a' t'}$ so that $(\dd+\one)u = \lambda u$ where $\lambda$ is some eigenvalue of $(\dd+\one)$ and $\dd u = (\lambda-1) u$.
In other words, $u$ is an eigenvector of the off-time-diagonal piece of $\dd$, which makes it an eigenvector of $\dd$ itself, since the only difference is the identity,
\begin{align}
    (\dd+\one)u &= \lambda u
    \nonumber\\
    (\dd+\one)_{\alpha a t, \alpha' a' t'}u_{\alpha' a' t'} &= \lambda u_{\alpha a t}
    \nonumber\\
	(-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} u_{\alpha' a' t'} &= \lambda u_{\alpha a t}
\end{align}
If we consider the vector $v$ such that $v_{\alpha a t} = e^{2\pi i t/N_t} u_{\alpha a t}$ then
\begin{align}
    [(\dd+\one)v]_{\alpha a t} = 
	(-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} v_{\alpha' a' t'} &=
	(-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} e^{2\pi i t' /N_t} u_{\alpha' a' t'} 
\end{align}
Since the right-hand side is 0 unless $t=t'+1$ we can replace $t'$ with $t-1$,
\begin{align}
    [(\dd+\one)v]_{\alpha a t}
    &=
	(-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} e^{2\pi i (t-1) /N_t} u_{\alpha' a' t'} 
    \nonumber\\
    &=
	e^{2\pi i (t-1) /N_t} (-1)^{[t'=N_t]} \BB\inverse_{aa''}\FF_{t' a''a'}^{\alpha\alpha'} \delta_{t,t'+1} u_{\alpha' a' t'} 
    =
    e^{2\pi i (t-1) /N_t} [(\dd+\one)u]_{\alpha a t}
\end{align}
since the phase now escapes the sum on $t'$.
But $(\dd+\one)u = \lambda u$ by assumption so
\begin{align}
    [(\dd+\one)v]_{\alpha a t}
    =
    e^{2\pi i (t-1) /N_t} \lambda u_{\alpha a t}
    =
	e^{-2\pi i /N_t} \lambda \left(e^{2\pi i t / N_t} u_{\alpha a t}\right)
    =
    e^{-2\pi i /N_t} \lambda v_{\alpha a t}
\end{align}
So, for every eigenvector of $\dd$ with eigenvalue $(\lambda-1)$ we can immediately construct another eigenvector with eigenvalue $(\lambda e^{2\pi i \cdot 1/N_t}-1)$, and another with $(\lambda e^{2\pi i\cdot 2/N_t}-1)$ and so on until we repeat with $e^{2\pi i \cdot N_t/N_t}=1$.

This only demonstrates that \emph{if you could find an eigenvector of $\dd$ you'd be in business}.
So: How can we construct eigenvectors of $\dd$ (or $\dd+\one$)?

Now it helps to think of $u$ as an $N_t$-vector of $2\times\Volume$ vectors and apply $(\dd+\one)$,
\begin{align}
    (\dd+\one) u &= \lambda u
    \nonumber\\
	\begin{bmatrix}
			0                               & 0                                 & 0                                 & 0         & \cdots & 0                                    & -\BB\inverse\FF_{N_t}(\tilde{h})
		\\	+\BB\inverse\FF_{1}(\tilde{h})  & 0                                 & 0                                 & 0         & \cdots & 0                                    & 0
		\\	0                               & +\BB\inverse\FF_{2}(\tilde{h})    & 0                                 & 0         & \cdots & 0                                    & 0
		\\	0                               & 0                                 & +\BB\inverse\FF_{3}(\tilde{h})    & 0         & \cdots & 0                                    & 0
		\\	\vdots                          & \vdots                            & \vdots                            & \vdots    & \ddots & \vdots                               & \vdots
		\\	0                               & 0                                 & 0                                 & 0         & \cdots & 0                                    & 0
		\\	0                               & 0                                 & 0                                 & 0         & \cdots & +\BB\inverse\FF_{N_t-1}(\tilde{h})   & 0
	\end{bmatrix}
    \begin{bmatrix}
            \uu_1
        \\  \uu_2
        \\  \uu_3
        \\  \uu_4
        \\  \vdots
        \\  \uu_{N_t-1}
        \\  \uu_{N_t}
    \end{bmatrix}
    &=
    \lambda
    \begin{bmatrix}
            \uu_1
        \\  \uu_2
        \\  \uu_3
        \\  \uu_4
        \\  \vdots
        \\  \uu_{N_t-1}
        \\  \uu_{N_t}
    \end{bmatrix}
\end{align}
where each $\uu$ is a $2\times\Volume$ vector.
This is (obviously) a set of linear equations
\begin{align*}
	\lambda \uu_1 &= -\BB\inverse \FF_{N_t} \uu_{N_t}
    \\
	\lambda \uu_2 &=+\BB\inverse \FF_{1} \uu_{1}
    \\
	\lambda \uu_3 &= +\BB\inverse \FF_{2} \uu_{2}
    \\
    \vdots \quad &= \qquad \vdots
    \\
    \lambda \uu_{N_t} &= +\BB\inverse \FF_{N_t} \uu_{N_t-1}
\end{align*}
If we multiply the first equation by $\lambda$ we can substitute the last equation in on the right-hand side.
Then multiply the resulting equation by $\lambda$ and substitute the second-to-last equation in, replacing $\uu_{N_t-1}$.
Take this procedure `all the way around' to find
\begin{align}
    \left(-\BB\inverse \FF_{N_t} \BB\inverse \FF_{N_t-1} \BB\inverse \cdots \FF_2 \BB\inverse \FF_1 \right) \uu_1 &= \lambda^{N_t} \uu_1
\end{align}
In other words the first $2\times\Volume$ entry of an eigenvector of $\dd+\one$ is an eigenvector of the sausage.
You can construct the remaining entries by using those linear equations, $\uu_2 = \lambda\inverse\BB\inverse \FF_1 \uu_1$, $\uu_3$ by applying $\lambda\inverse \BB\inverse \FF_2$ to $\uu_2$ and so on.
One also need not focus on $\uu_1$; just rotate the sausage and find its eigenvectors to get the eigen-$\uu$s of interest.

This is marvelous: if you can reliably construct the block sausage you need only calculate its $2\times\Volume$ eigenvectors and you get the $2\times\Volume\times N_t$ eigenvectors of $\dd$.
{\bf I have not considered the numerical stability or tractability of this procedure, but presumably if we can construct the sausage in a stable way everything else follows.}
For a detailed discussion of this operator see \Ref{Wynen:2018ryx} (it is the `exponential $\alpha=0$' operator), where it is shown $\dd$ has an ergodicity problem when the lattice is bipartite (if $\vec{h}=0$).
\emph{For that reason we always pick a lattice with an odd number of sites on at least one side.}

\subsection{Correlation Functions}\label{sec:correlation functions}

We often want to evaluate not just the partition function but the expectation value of some operators, such as $\expectation{\tilde{n}_\sigma(a)}$ or $\expectation{\tilde{n}_{\sigma}(a)\tilde{n}_{\sigma'}(a')}$ for some spins $\sigma, \sigma'$ and (dimensionless) positions $a, a'$.
Let us currently restrict our attention to equal-time correlators on the same, first, timeslice, so that numerically we wish to evaluate
\begin{align}
	\expectation{\O}
	=
	\oneover{Z} \tr{ \left(\prod_{t=1}^{N_t} e^{-\Delta\tilde{t} \tilde{K}} e^{-\Delta\tilde{t}(\tilde{V} -\tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})}\right) \O}.
	\label{eq:expectation}
\end{align}
One may of course work with the operators directly and re-perform the Grassmann algebra with the operator inserted.
However, functional differentiation produces the exact same answer and is easier to perform.

Let us add to the chemical potential and external field terms space- and time-dependent perturbations;
\begin{align}
	\mu &\goesto \mu_{t,a} = \mu + \delta \mu_{t,a}
	&
	\vec{h} &\goesto \vec{h}_{t,a} = \vec{h} + \delta \vec{h}_{t,a}
	\\\
	\tilde{\mu} \tilde{N} & \goesto \sum_a \tilde{\mu}_a \tilde{n}_a = \tilde{\mu}\tilde{N} + \sum_a \delta\tilde{\mu}_a \tilde{n}_a
	&
	\tilde{\vec{h}} \cdot \tilde{\vec{S}} & \goesto \sum_a \tilde{\vec{h}}_a\cdot \tilde{\vec{S}}_a = \tilde{\vec{h}}\cdot\tilde{\vec{S}} + \sum_a \delta\tilde{\vec{h}}_a \cdot \tilde{\vec{S}}_a
	&
	Z &\goesto Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}});
	\label{eq:local perturbations}
\end{align}
and the perturbation can be different on each timeslice.
We will functionally differentiate the modified partition function $Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})$ with respect to these perturbations and then set them to zero.
For example
\begin{align}
	\left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} \log Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\mu=0, \delta\vec{h}=0}
	&=
	\left.\oneover{Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\nonumber\\
	&=
	\left.\oneover{Z} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\label{eq:functionally differentiate}\\
	&=\oneover{Z} \tr{\left(\prod_{t=1}^{N_t}e^{-\Delta\tilde{t} \tilde{K}} e^{-\Delta\tilde{t}(\tilde{V} -\tilde{\mu}\tilde{N} - \tilde{\vec{h}}\cdot\tilde{\vec{S}})}\right) \tilde{n}_a} 
	= \expectation{\tilde{n}_a}.
\end{align}
where in the last line we specialized to differentiating with respect to a fluctuation on timeslice 1; functionally differentiating with respect to a fluctuation on a different timeslice simply inserts $\tilde{n}_a$ in the middle of the Trotterized product but by time translation invariance (or the cyclicity of the trace) we can bring the trace into a similar form with the operator rightmost.

We may replace $Z$ with our computationally-tractable auxiliary-field formulation in the functional derivative \eqref{functionally differentiate} to get estimators of the desired expectation value.
Since the perturbations \eqref{local perturbations} are spacetime local they go into the fermion matrix $\dd$ \eqref{fermion matrix} and the sausage $\UU$ \eqref{sausage} straightforwardly by making the promotions from space (and time) constants.
Inserting the auxiliary-field formulation of $Z$ \eqref{computational partition function} into the derivative one finds
\begin{align}
	\expectation{\tilde{n}_a} &= \left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} \log Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\mu=0, \delta\vec{h}=0}
	=
	\left.\oneover{Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	=
	\left.\oneover{Z} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} Z(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\nonumber\\
	&=
	\left.\oneover{Z} \oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}}
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t - \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }}
	~	\det \left(\one + \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}}) \right)
	\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\nonumber\\
	&=
	\oneover{Z}
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t - \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }}
	~	\left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}}
	~	\det \left(\one + \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}}) \right)\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	\nonumber\\
	&=
	\oneover{Z}
		\int DA\; e^{-\frac{1}{2} \sum_t A\transpose_t (-\Delta\tilde{t} \tilde{V})\inverse A_t - \frac{N_t}{2} \trlog{ -2\pi \Delta\tilde{t}\tilde{V} }}
		\det \left(\one + \UU \right) \tr{\left(\one + \UU \right)\inverse \left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}}
	\label{eq:fermionic particle number}
\end{align}
where $\UU$ with no arguments has the local fluctuations st to zero and we assume that $(1+\UU)$ is invertible so that the derivative of the determinant may be replaced via the identity $\partial \det{A} = \det A ~ \tr{ A\inverse \partial A}$.

Now we need to know the derivatives of the ingredients of the sausage, evaluated at 0 fluctuation.
Since $\BB$ only changes with the hopping parameter or with the lattice geometry, we focus on derivatives of $\FF$.
The simplest is
\begin{align}
	\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{t,a}} \FF_{t'} &= \delta_{tt'} \FF_{t'} \PP_a
	&
	\left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{\mu}_{1,a}} \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	&= \UU \PP_a
\end{align}
where $\PP_a$ is a spin-independent projector to site $a$.
This derivative is simple because $\tilde{\mu}$ appears inside the matrix exponential $\FF$ \eqref{FF} coupled to the (spin) identity, and the identity commutes with all the Pauli matrices.
In the generic case, where $\vec{h}\neq0$ the functional derivatives of $\FF$ with respect to the external field is not simple,
\begin{align}
	\left.\oneover{\Delta\tilde{t}}\frac{\partial}{\partial \delta \tilde{h}^i_{t,a}} \FF_{t'}\right|_{\delta\tilde{\mu} = 0, \delta \tilde{h}=0}
	&=
	\delta_{tt'}\PP_a e^{A_t + \Delta\tilde{t}\tilde{\mu}}\left(
		\left[\frac{\tilde{h}^i_{t,a}}{2 \abs{\tilde{h}}} + \frac{\sigma^i/\Delta\tilde{t}}{\abs{\tilde{h}}}\right]\sinh \Delta\tilde{t}\abs{\tilde{h}}
		+
		\tilde{\vec{h}}\cdot\vec{\sigma} \left[
				\frac{\tilde{h^i}}{2 \abs{\tilde{h}}^2} \cosh \Delta\tilde{t} \abs{\tilde{h}}
			-	\frac{\tilde{h^i}}{\Delta\tilde{t} \abs{\tilde{h}}^{3}} \sinh \Delta\tilde{t} \abs{\tilde{h}}
		\right]
	\right).
	\label{eq:dF}
\end{align}
To be able to cleanly write the derivative of $\UU$ in the generic case we multiply \eqref{dF} by the the identity $\FF\FF\inverse$.
After much massaging and cancellation one finds, suppressing the (common) argument of sinh and cosh $\half\Delta\tilde{t}\abs{\tilde{h}}$ for brevity,
\begin{align}
	\left.\oneover{\Delta\tilde{t}}\frac{\partial}{\partial \delta \tilde{h}^i_{t,a}} \FF_{t'}\right|_{\delta\tilde{\mu} = 0, \delta \tilde{h}=0}
	&= \delta_{tt'} \FF_{t'} \PP_a \left[
				\half \hat{h}^i \hat{h}^k
			+	\frac{\sinh \cosh}{\Delta\tilde{t} \abs{\tilde{h}}} \left(\delta^{ik}-\hat{h}^i\hat{h}^k\right)
			+	\frac{i \sinh^2}{\Delta\tilde{t} \abs{h}} \epsilon_{ijk} \hat{h}^j
		\right]\sigma_k
	\label{eq:dFdh factor}
\end{align}
so that if we differentiate $\UU$ with respect to a fluctuation of $\tilde{h}$ on timeslice 1 we can just append everything after $\FF_t$ to the right of $\UU$; on other timeslices we make the similar insertion to the right of $\FF_t$.
When $\vec{h}=0$ we have the simplification (by taking a careful limit, holding $\hat{h}$ a unit vector)
\begin{align}
	\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{h}^i_{t,a}} \FF_{t'} &= \delta_{tt'} \FF_{t'} \half \sigma^i \PP_a
	&
	\left.\oneover{\Delta\tilde{t}} \frac{\partial}{\partial \delta\tilde{h}^i_{1,a}} \UU(\delta\tilde{\mu}, \delta\tilde{\vec{h}})\right|_{\delta\tilde{\mu}=0, \delta\tilde{\vec{h}}=0}
	&= \UU \half \sigma^i \PP_a = \UU \PP_a \half\sigma^i 
	&
	(\vec{h} &\goesto 0)
	\label{eq:dFdh with h=0}
\end{align}
From the more explicit form \eqref{dFdh factor} we can see how the $\tilde{h}\goesto0$ limit \eqref{dFdh with h=0} emerges; the last term vanishes while the $\delta$ term survives and the $\hat{h}^i\hat{h}^k$ terms cancel.

Finally, note that if we take the inner product of the matrix element \eqref{dFdh factor} with $\hat{h}$ one finds
\begin{align}
	\hat{h}^i \left.\oneover{\Delta\tilde{t}}\frac{\partial}{\partial \delta \tilde{h}^i_{t,a}} \FF_{t'}\right|_{\delta\tilde{\mu} = 0, \delta \tilde{h}=0}
	&= \delta_{tt'} \FF_{t'} \PP_a \half(\hat{h}\cdot\sigma)
\end{align}
as expected.
