\subsection{Vortex-Sensitive Observables}\label{sec:vortex}

The BKT transition is a transition between no vortices (at low temperature) and lots of vortex/antivortex pairs (at high temperature), which is driven by the entropic considerations of where all the vortices can be~\cite{1971JETP...32..493B,1972JETP...34..610B,Kosterlitz:1973}.
\Ref{PhysRevLett.129.076403} provides an analysis of the BKT transition by studying the condensate fraction [their (2)] and the Cooper pair momentum distribution [their (3)].
This transition is topological, in the sense that there isn't a good local order parameter to capture the change we're talking about.
Consider, for example, an observable that measures the local vorticity, like
\begin{align}
	\omega^3_x = \text{curl}(j)_x = \grad \times \vec{j}_x = \epsilon^{3mn} \partial^m j^n_x.
\end{align}
By periodic boundary conditions the net vorticity vanishes
\begin{align}
	\sum_x \omega^3_x = 0
	\label{eq:net vorticity}
\end{align}
if the current $j$ corresponds obeys a lattice continuity equation, since particles cannot leave across a boundary without coming back `on the other side'.
(The vorticity is entirely in the 3 direction, since the fermions are confined to 2D; in what follows we suppress the 3 superscript.)
This vanishes exactly because of the periodic boundary conditions; the boundary-condition-dependence is a hint it's accessing something topological.

We can now find $\omega$ as a function of momentum.
Fourier transforming,
\begin{align}
	\omega^3_k
	= \sum_x \Delta x^2 e^{-ikx} \omega^3_x
	= \sum_x \Delta x^2 e^{-ikx} \grad \times \vec{j}_x
	&= \sum_x \Delta x^2 e^{-ikx} \grad \times \oneover{\Volume \Delta x^2} \sum_p e^{+ipx} \vec{j}_p
\nonumber\\
	&= \sum_p i\vec{p} \times \vec{j}_p \oneover{\Volume} \sum_x e^{i(p-k)x}
	= \sum_p i\vec{p} \times \vec{j}_p \delta_{pk}
	= i \vec{k} \times \vec{j}_k
\end{align}
which shows that the total vorticity is 0.
Moreover, when calculating the vorticity we can drop the piece proportional to the momentum itself,
\begin{align}
	\omega^3_k
	= i \vec{k} \times \left(\vec{j}_k = \half\oneover{M \Volume\Delta x^2} \sum_q (\vec{k}+2\vec{q}) \psi\adjoint_{q} \psi_{k+q}\right)
	= i \half\oneover{M \Volume\Delta x^2} \sum_q \left(\vec{k} \times (\vec{k}+2\vec{q})\right) \psi\adjoint_{q} \psi_{k+q}
\nonumber\\
	= \oneover{M \Volume\Delta x^2} \sum_q (i\vec{k} \times \vec{q}) \psi\adjoint_{q} \psi_{k+q}
\end{align}

Actually, $\omega_k$ is not an observable; only $\omega_0$ is Hermitian (and 0!):
\begin{align}
    M\Volume \Delta x^2 \omega\adjoint_k
    &= \sum_q (-i) \vec{k} \times \vec{q} \psi\adjoint_{k+q} \psi_{q}
    \nonumber\\
    &= \sum_{q' = q+k} (-i) \vec{k} \times (\vec{q}' - \vec{k}) \psi\adjoint_{k+q'-k} \psi_{q'-k}
    \nonumber\\
    &= \sum_{q'} i (-i\vec{k}) \times \vec{q}' \psi\adjoint_{q'} \psi_{q'-k} = M \Volume \Delta x^2 \omega_{-k}.
\end{align}
Therefore, $\omega_{-k} \omega_{k} = \omega\adjoint_k \omega_k$ \emph{is} observable.

Instead of the total vorticity \eqref{net vorticity}, which must vanish by periodic boundary conditions, consider the vorticity-vorticity two-point correlation
\begin{align}
	\Omega_{\delta x} &= \oneover{\Volume \Delta x^2} \sum_x \Delta x^2 \Omega_{x,x-\delta x}
&	\Omega_{xy} &= \omega\adjoint_x \omega_y.
\end{align}
If there were one vortex/antivortex pair that were well-separated the correlations would reach far as a function of the separation $\delta$.
But when there are very many vortices and antivortices $\Omega$ should decay quickly.
Evaluated via convolution, one finds
\begin{align}
	\Omega_{\delta x}
	= \oneover{M^2}\left(\oneover{\Volume \Delta x^2}\right)^2 \sum_p e^{-ip \cdot \delta x} \omega\adjoint_p \omega_p
	= \oneover{M^2}\left(\oneover{\Volume \Delta x^2}\right)^4 \sum_{pkq} e^{-ip \cdot \delta x} (\vec{p}\times\vec{q})\cdot(\vec{p}\times\vec{k}) \psi\adjoint_{p+q}\psi_q\psi\adjoint_k\psi_{p+k}
\end{align}
where the dot product between the cross products arises naturally from considering $\omega\adjoint \cdot \omega$ (and we focus on the $z$ direction when the momenta are all confined to the plane).
Using a vector identity one finds
\begin{align}
	\Omega_{\delta x}
	= \oneover{M^2}\left(\oneover{\Volume \Delta x^2}\right)^4 \sum_{pkq} e^{-ip \cdot \delta x} \left[p^2 (k\cdot q) - (p\cdot k)(p\cdot q)\right] \psi\adjoint_{p+q}\psi_q\psi\adjoint_k\psi_{p+k}
\end{align}
with no need to subtract a disconnected piece; that piece is 0 by translation invariance, since $\expectation{\omega_x} = \oneover{\Volume} \expectation{\sum_x \omega_x} = 0$.
